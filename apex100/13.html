<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>100 Days of Apex | Admin2Dev</title>
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Alata:400%7CMuli:400,400i,700,700i&amp;display=swap&amp;subset=latin-ext" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../assets/css/screen_v=dedafe7ddd.css">

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-112097931-2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'UA-112097931-2');
  </script>

</head>


<body class="page-template page-style-guide global-hash-authors-link global-hash-full-image global-hash-tags-link">
  <div class="global-wrap">
    <div class="global-content">
      <header class="header-section">
        <div class="header-wrap">
          <div class="header-logo">
            <h1 class="is-logo"><a href="../index.html"><img src="../images/logo.svg" alt="Admin2Dev Logo"></a></h1>
          </div>
          <div class="header-nav">
            <input id="toggle" class="header-checkbox" type="checkbox">
            <label class="header-toggle" for="toggle">
              <span>
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
              </span>
            </label>
            <nav>
              <ul>
                <li><a href="../index.html">Home</a></li>
                <li><a href="../apex100/index.html">Learn</a></li>
                <li><a href="../about.html">About</a></li>

              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main class="global-main">
        <article class="post-section">
          <div class="post-header">
            <div class="post-title-wrap">
              <div class="post-title-content">
                <h1 class="post-title global-title">Day 13:<br />Week 2 Test</h1>
              </div>
            </div>
          </div>
          <div class="post-content">
            <p>You made it to the end of week 2! This quick test is made to test your basic understanding of everything you’ve learnt til now!</p>
            <ul>
              <li>You can look at the syntax, bonus points if you don’t.</li>
              <li>The test should ideally not take more than 20 minutes to solve.</li>
              <li>All the criterias must be met.</li>
              <li>The answer is available at <a href="https://github.com/Admin2Dev/answers" target="_blank">Admin2Dev GitHub Repo</a>.</li>
              <li>The answer and complete breakdown of the program is available at the end of this page.</li>
            </ul>
            <h2>The Test</h2>
            <h2>Question</h3>
              <p>Write a Trigger <code>oppUpdate</code> and a helper class must be named <code>oppUpdateHelper</code> with methods that:</p>
              <ul>
                <li>Creates a new Task whenever an Opportunity is inserted.</li>
                <li>Creates a new Task whenever an Opportunity is updated, unless it is ‘Closed Lost’ or ‘Closed Won’. The task subject should match it’s current stage.</li>
                <li>Creates a new Task if the opportunity changes from ‘Needs Analysis’ to ‘Closed Lost’.</li>
              </ul>
              <hr>
              <blockquote>
                <p>Start a timer and note how long you take to solve. Ideally, it should take ~30 minutes, but don’t worry if you go overboard.</p>
              </blockquote>
              <hr>
              <h2>Answer</h3>
                <h2>Creating a task when an opportunity is inserted</h4>
                  <p><strong>Trigger</strong></p>
                  <pre><code>trigger oppUpdater on Opportunity (after insert) {

    if(Trigger.isafter){
        if (Trigger.isInsert){
            oppUpdaterHelper.oppInsertTask(trigger.new);

        }
    }
}
</code></pre>
                  <p><strong>Class Helper</strong></p>
                  <pre><code>public class oppUpdaterHelper{

    public static void oppInsertTask(List&lt;Opportunity&gt; oppList){

        List&lt;Task&gt; finalList = new List&lt;Task&gt;();

        for (Opportunity iterator: oppList){
            Task newTask = new Task();
            newTask.WhatId = iterator.id;
            newTask.Subject = 'New task';
            finalList.add(newTask);
        }
        insert finalList;
    }

}
</code></pre>
                  <h2>Create a New task unless ‘Closed Won’ or ‘Closed Lost’</h4>
                    <p><strong>Trigger</strong></p>
                    <pre><code>trigger oppUpdater on Opportunity (after insert) {

    if(Trigger.isafter){
        if (Trigger.isInsert){
            oppUpdaterHelper.oppInsertTask(trigger.new);
            oppUpdaterHelper.oppClosedTask(trigger.new);
        }
    }
}
</code></pre>
                    <p><strong>Class Helper</strong></p>
                    <pre><code>public class oppUpdaterHelper{

    public static void oppInsertTask(List&lt;Opportunity&gt; oppList){

        List&lt;Task&gt; finalList = new List&lt;Task&gt;();

        for (Opportunity iterator: oppList){
            Task newTask = new Task();
            newTask.WhatId = iterator.id;
            newTask.Subject = 'New task';
            finalList.add(newTask);
        }
        insert finalList;
    }

    public static void oppClosedTask(List&lt;Opportunity&gt; oppList){

        List&lt;Task&gt; finalList = new List&lt;Task&gt;();

        for (Opportunity iterator: oppList){
            if (iterator.StageName == 'Closed Won' || iterator.StageName == 'Closed Lost'){
                //Do nothing. Optionally, use != operator
            }
            else{
                Task newTask = new Task();
                newTask.WhatId = iterator.id;
                newTask.Subject = iterator.StageName;
                finalList.add(newTask);
            }
        }
        insert finalList;
    }

}
</code></pre>
                    <h2>Creates a new Task if the opportunity changes from ‘Needs Analysis’ to ‘Closed
                      Lost’.</h4>
                      <p><strong>Trigger</strong></p>
                      <pre><code>trigger oppUpdater on Opportunity (after insert, after update) {

    if(Trigger.isafter){
        if (Trigger.isInsert){
            oppUpdaterHelper.oppInsertTask(trigger.new);
            oppUpdaterHelper.oppClosedTask(trigger.new);
        }

        if (Trigger.isUpdate){
            oppUpdaterHelper.oppChangeTask(trigger.oldMap, trigger.new);
        }
    }
}
</code></pre>
                      <p><strong>Class Helper</strong></p>
                      <pre><code>public class oppUpdaterHelper{

    public static void oppInsertTask(List&lt;Opportunity&gt; oppList){

        List&lt;Task&gt; finalList = new List&lt;Task&gt;();

        for (Opportunity iterator: oppList){
            Task newTask = new Task();
            newTask.WhatId = iterator.id;
            newTask.Subject = 'New task';
            finalList.add(newTask);
        }
        insert finalList;
    }

    public static void oppClosedTask(List&lt;Opportunity&gt; oppList){

        List&lt;Task&gt; finalList = new List&lt;Task&gt;();

        for (Opportunity iterator: oppList){
            if (iterator.StageName == 'Closed Won' || iterator.StageName == 'Closed Lost'){
                //Do nothing. Optionally, use != operator
            }
            else{
                Task newTask = new Task();
                newTask.WhatId = iterator.id;
                newTask.Subject = iterator.StageName;
                finalList.add(newTask);
            }
        }
        insert finalList;
    }

    public static void oppChangeTask(Map&lt;ID, Opportunity&gt; oldList, List&lt;Opportunity&gt; newList){


        for(Opportunity iterator: newList){

            Opportunity oldOpp = oldList.get(iterator.id);

            Boolean oldValue = oldOpp.stageName.equals('Needs Analysis');
            Boolean newValue = iterator.StageName.equals('Closed Lost');

            if(oldValue &amp;&amp; newValue){
                Task newTask = new Task();
                newTask.WhatId = iterator.id;
                newTask.Subject = 'Closed Lost';
                insert newTask;
            }
        }
    }

}</code></pre>

                      <a href="14.html" class="global-button"> Day 14 </a>
          </div>
        </article>

      </main>
      <footer class="footer-section global-footer">
        <div class="footer-copyright">
          &copy; <a href="http://harshdeephura.com" target="_blank">Harshdeep Singh Hura</a>.<br />All Rights Reserved.
        </div>
      </footer>
    </div>
  </div>

  <script src="assets/js/global_v=dedafe7ddd.js"></script>
  <script src="assets/js/index_v=dedafe7ddd.js"></script>

</body>

</html>
