<html lang="es-ES"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Curso Apex Starter | Admin2Dev</title>
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@500&amp;family=Spartan:wght@500;600;700&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Muli:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../assets/css/stylesheet.css">

  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

  <meta property="og:site_name" content="Admin2Dev">

  <meta property="og:title" content="Scheduled Apex Class"> <!-- Content Title-->
  <meta property="og:description" content="Learn the basics of scheduling an apex class to run at a later time and date"> <!-- Content Description -->
  <meta property="og:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:url" content="https://admin2dev.com/">


  <meta property="article:author" content="https://twitter.com/kinngh">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Scheduled Apex Class"> <!-- Twitter Title -->
  <meta name="twitter:description" content="Learn the basics of scheduling an apex class to run at a later time and date"> <!-- Twitter description -->
  <meta name="twitter:url" content="https://admin2dev.com">
  <meta name="twitter:label1" content="Written by">
  <meta name="twitter:data1" content="Harshdeep Singh Hura">
  <meta name="twitter:label2" content="Filed under">
  <meta name="twitter:data2" content="Apex Tutorials">
  <meta name="twitter:site" content="@kinngh">
  <meta name="twitter:creator" content="@kinngh">
  <meta name="twitter:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-112097931-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'UA-112097931-2');
</script><script async="" src="https://hm-ackee.herokuapp.com/tracker.js" data-ackee-server="https://hm-ackee.herokuapp.com" data-ackee-domain-id="44278298-d601-4fe2-8430-af54e1945ef8"></script>

</head>

<body id="myBody" class="global-hash-post-card-amber global-hash-post-card-apricot global-hash-post-card-aqua global-hash-post-card-coral global-hash-post-card-cream global-hash-post-card-green global-hash-post-card-purple global-hash-post-card-raspberry global-hash-post-card-sky global-hash-dark-version is-loaded">
  <div class="global-wrap">
    <div class="global-content">
      <header class="header-section">
        <div class="header-wrap">
          <div class="header-logo">
            <a href="../index.html" class="is-image">
              <img src="../images/logo.png" alt="Admin2Dev">
            </a>
          </div>
          <div class="header-nav">
            <input id="toggle" class="header-checkbox" type="checkbox">
            <label class="header-toggle" for="toggle">
              <span>
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
              </span>
            </label>
            <nav>
              <ul>
                <li><a href="../index.html">Inicio</a></li>
                <li><a href="../learn/index.html">Aprender</a></li>
<li><a href="../tools/index.html">Herramientas</a></li>
                 <li><a href="../sponsor/index.html">Patrocinador</a></li>
                <li class="header-nav-dropdown">
                  <svg role="img" viewBox="0 0 20 4" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 4A2 2 0 102.001.001 2 2 0 002 4zm8 0a2 2 0 10.001-3.999A2 2 0 0010 4zm8 0a2 2 0 10.001-3.999A2 2 0 0018 4z"></path></svg>
                  <ul>
                    <li><a href="../about/index.html">Acerca de</a></li><li><a href="../terms.html">Condiciones del servicio</a></li>
                    <li><a href="../privacy.html">Política de privacidad</a></li>
                  </ul>
                </li>
              </ul>
              <ul>
                <li class="signup global-button"><a href="https://discord.gg/5ndr5F8" target="_blank">Únete a la comunidad</a></li>
                <li class="signin"><a onclick="darkMode()" id="darkModeText">Modo de luz</a></li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main class="global-main">
        <article class="post-section">
          <div class="post-header item is-hero is-page is-first post no-image page">
            <div class="item-container global-color">
              <div class="item-content">
                <h2 class="item-title">Clase de ápice programada</h2>
              </div>
            </div>
          </div>
          <div class="post-content">
            <p>La mayoría de nosotros tenemos una rutina matutina, ya sea despertar temprano y hacer el desayuno para toda la familia y salir al trabajo o despertar 5 minutos antes de que se supone que te vayas y tomar café como desayuno y salir con prisa. Hay ciertas actividades que deben ocurrir de forma regular e incluso en el trabajo, podría ser enviar un correo electrónico con la actualización de hoy sobre oportunidades, o estadísticas de ingresos mensuales o informes anuales sobre cómo se está desempeñando la empresa. Para automatizar nuestro código, utilizamos <em>Ápice Programado</em>.</p>
            <p>Como su nombre indica, Scheduled Apex ejecuta una tarea en marcos de tiempo específicos definidos por el desarrollador. Una clase programada implementa <em>Scheduleable </em>y tiene un método <code>execute()</code>. Echemos un vistazo a la sintaxis:</p>
            <pre><code>global class SomeClass implements Schedulable {
                global void execute(SchedulableContext ctx) {
                    //Code Here
                }
            }</code></pre>
            <ul>
              <li>Una clase de horario siempre es<code>global</code></li>
              <li>La clase debe implementar<code>Schedulable</code></li>
              <li>La clase debe tener un método <code>execute()</code>.</li>
              <li>The <code>SchedulableContext ctx</code> is just like the Batch Class' <code>Database.BatchableContext bc</code>, it is the jobID of the schedule class.</li>
            </ul>
            <p>Es una buena práctica llamar a su Clase por lotes / Clase Apex desde su Clase de Programación en lugar de llenarla con código. Llamemos a una clase por lotes:</p>
            <pre><code>global class ClassSchedule implements Schedulable {
                global void execute(SchedulableContext ctx) {
                    //Code Here
                    BatchClass tester = new BatchClass();
                    Database.executeBatch(tester);
                }
            }</code></pre>
            <p>We made a new class called <code>ClassSchedule</code> that implements <code>Schedulable</code> and called our batch class from the <code>execute()</code> method. Nice and simple. Now let's schedule it.</p>
            <p>Al programar la clase, se ejecuta en la <em>zona horaria del usuario que la está ejecutando</em>, y para la mayoría de las partes esa es la zona horaria del desarrollador.</p>
            <p>Para programar una clase, primero hacemos una nueva instancia.</p>
            <pre><code>ClassSchedule schClass = new ClassSchedule();</code></pre>
            <p>Now, we setup time using a very specific format.
              <code>Seconds Minutes Hours Day_Of_Month Month Day_Of_Week Optional_Year</code>.</p>
            <p>Aquí está el marcado en valores:</p>
            <div class="responsive-table">
              <table>
                <thead>
                  <tr>
                    <th>Nombre</th>
                    <th>Valores</th>
                    <th>Personajes especiales</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Segundos</td>
                    <td>0–59</td>
                    <td>Ninguno</td>
                  </tr>
                  <tr>
                    <td>Minutos</td>
                    <td>0–59</td>
                    <td>Ninguno</td>
                  </tr>
                  <tr>
                    <td>Horas</td>
                    <td>0–23</td>
                    <td>Ninguno</td>
                  </tr>
                  <tr>
                    <td>Día_del_mes</td>
                    <td>1–31</td>
                    <td>, - * ? / L W</td>
                  </tr>
                  <tr>
                    <td>Mes</td>
                    <td>1-12 o Primeras tres letras de meses (EN - DIC)</td>
                    <td>, - * /</td>
                  </tr>
                  <tr>
                    <td>Día_de_semana</td>
                    <td>1-7 o Primeras tres letras del día (SUN - SAT)</td>
                    <td>, - * ? / L #</td>
                  </tr>
                  <tr>
                    <td>optional_year</td>
                    <td>nulo o 1970-2099</td>
                    <td>, - * /</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>Desglose de caracteres especiales:</p>
            <div class="responsive-table">
              <table>
                <thead>
                  <tr>
                    <th>Carácter especial</th>
                    <th>Descripción</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>,</td>
                    <td>Delimits values. For example, use <code>JAN, MAR, APR</code> to specify more than one month.</td>
                  </tr>
                  <tr>
                    <td>-</td>
                    <td>Specifies a range. For example, use <code>JAN-MAR</code> to specify more than one month.</td>
                  </tr>
                  <tr>
                    <td>*</td>
                    <td>Especifica todos los valores. Por ejemplo, si Month se especifica como <code>*</code>, el trabajo está programado para cada mes.</td>
                  </tr>
                  <tr>
                    <td>?</td>
                    <td>Specifies no specific value. This is only available for <code>Day_of_month</code>and <code>Day_of_week</code>, and is generally used when specifying a value for one and not the other.</td>
                  </tr>
                  <tr>
                    <td>/</td>
                    <td>Specifies increments. The number before the slash specifies when the intervals will begin, and the number after the slash is the interval amount. For example, if you specify <code>1/5</code> for Day_of_month, the Apex class
                      runs every fifth day of the month, starting on the first of the month.</td>
                  </tr>
                  <tr>
                    <td>L</td>
                    <td>Specifies the end of a range (last). This is only available for <code>Day_of_month</code> and <code>Day_of_week</code>. When used with Day of month, L always means the last day of the month, such as January 31, February 29 for
                      leap years, and so on. When used with Day_of_week by itself, it always means 7 or SAT. When used with a Day_of_week value, it means the last of that type of day in the month. For example, if you specify 2L, you are specifying
                      the last Monday of the month. Do not use a range of values with L as the results might be unexpected.</td>
                  </tr>
                  <tr>
                    <td>W</td>
                    <td>Specifies the nearest weekday (Monday-Friday) of the given day. This is only available for <code>Day_of_month</code>. For example, if you specify <code>20W</code>, and the 20th is a Saturday, the class runs on the 19th. If you
                      specify 1W, and the first is a Saturday, the class does not run in the previous month, but on the third, which is the following Monday. Use the L and W together to specify the last weekday of the month.</td>
                  </tr>
                  <tr>
                    <td>#</td>
                    <td>Especifica el enésimo día del mes, en el formato weekday#day_of_month. Esto solo está disponible para Day_of_week. El número anterior al # especifica el día de la semana (SUN-SAT). El número después del # especifica el día del mes. Por ejemplo, especificar 2#2 significa que la clase se ejecuta el segundo lunes de cada mes.</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>Comprender las tablas podría ser un poco difícil, así que tomemos algunos ejemplos:</p>
            <div class="responsive-table">
              <table>
                <thead>
                  <tr>
                    <th>Expresión</th>
                    <th>Descripción</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><code>0 0 13 * * ?</code></td>
                    <td>La clase funciona todos los días a la 1 PM.</td>
                  </tr>
                  <tr>
                    <td><code>0 0 22 ? * 6L</code></td>
                    <td>La clase se celebra el último viernes de cada mes a las 10 PM.</td>
                  </tr>
                  <tr>
                    <td><code>0 0 10 ? * MON-FRI</code></td>
                    <td>La clase se imparte de lunes a viernes a las 10 AM.</td>
                  </tr>
                  <tr>
                    <td><code>0 0 20 * * ? 2010</code></td>
                    <td>La clase funciona todos los días a las 20:00 horas durante el año 2010.</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>Estoy escribiendo esto a las 3:52 a.m. y quiero programar mi clase para que funcione a las 4 a.m. todos los días</p>
            <pre><code>String sch = '0 0 4 * * ?';</code></pre>
            <ul>
              <li>First two values denoting seconds and horus is <code>0</code> and the third value is <code>4</code> so that means the time is <code>04:00</code> or 4AM.</li>
              <li>The next two values are <code>*</code> denoting we want Day_of_the month and Month to be <em>all</em> values, so 1st through 31st, Jan to Dec.</li>
              <li>El Día_de_semana es un <code>?</code> denotando que no queremos especificar un valor <em>porque ya hemos especificado valores para nuestro valor day_of_month, por lo que esto no requiere un valor</em></li>
              <li>El año se omite porque es un valor opcional.</li>
            </ul>
            <p>This might take some time to understand and I still refer to this chart and spend a solid minute writing <em>when</em> to run so don't worry if you don't get it right away. Now that we have <em>what</em> and <em>when</em> to run, let's
              actually execute it. To do this, we use the <code>System.schedule()</code> class method that takes three parameters:</p>
            <ul>
              <li>Nombre (Cadena) del trabajo.</li>
              <li>Tiempo (Cadena) llamado Tiempo Cron.</li>
              <li>Clase programada (variable).</li>
            </ul>
            <p>Al igual que nuestra ejecución de la clase por lotes, guardamos el ID en una variable. Escribámoslo todo junto en una ventana de Anon Exec:</p>
            <pre><code>ClassSchedule classer = new ClassSchedule();
            String sch = '0 0 4 * * ?'; //run everyday at 4
            String jobId = system.schedule('classScheduler', sch, classer);
            System.debug(jobId);</code></pre>
            <p>Después de que se ejecute nuestro código, diríjase a Configuración y busque <em>Trabajos Programados </em>y notará que hay un nuevo trabajo programado para el tiempo que especificó. (Corré el mío a las 3:55 a.m. porque estaba inquieto.)</p>
            <figure class="kg-card kg-width-full kg-card-hascaption"><img src="../images/apex/20/1.png" width="100%" alt="Clase programada en la configuración">
            </figure>
            <p>Hay una opción de eliminación aquí para eliminar el trabajo programado. Es posible reprogramar la clase desde el código, pero he visto a desarrolladores experimentados eliminar el trabajo y programar uno nuevo para la clase para evitar confusiones. Ahora que sabemos cómo escribir una clase de programación, escribamos la clase de prueba para ella.</p>
            <h2>Clase de prueba</h2>
            <p>Personalmente, escribir una clase de prueba para la clase programada se siente como una formalidad solo porque la mayoría de las clases programadas que he escrito durante el último año se llamaban Clase por lotes y esas clases ya tenían Pruebas escritas, pero como siempre aspiramos a una cobertura de código del 100%, solo necesitamos llamar a la Clase Programada una vez. También he visto a los desarrolladores seguir la misma práctica.</p>
            <p>For this, we need to define a <em>Time</em> string, but call the Scheduled class inside the <code>Test.startTest()</code> and <code>Test.stopTest()</code> because <em>this forces the scheduled class to run immediately on the test
                database</em> because we really don't want to wait for testing it.</p>
            <pre><code>@isTest
            public class ClassScheduleTest {
                public static String sch_test = '0 32 4 * * ?'; //define time

                static testmethod void testerMethod(){

                    Test.startTest();
                    ClassSchedule tester = new ClassSchedule();
                    String jobId = System.schedule('Test Class', sch_test, tester);
                    Test.stopTest();


                }
            }</code></pre>
            <p>Las clases programadas tienen ciertas limitaciones que discutiremos cuando examinemos hacer llamadas HTTP desde clases Apex.</p>
            <h1>Resumen</h1>
            <ul>
              <li>Las clases programadas se ejecutan en el marco de tiempo establecido por el desarrollador.</li>
              <li>La clase siempre se ejecuta en función de la zona horaria del usuario</li>
              <li>Escribir clases de prueba para las clases programadas es en su mayoría redundante y un enfoque práctico es escribir una clase de prueba para las clases a las que llama y una prueba de nombre para dicha clase programada solo para lograr una cobertura de código del 100%.</li>
            </ul>

            <a href="21.html" class="global-button">Día 21: API de redes y REST</a>
          </div>
        </article>

      </main>
      <footer class="footer-section global-footer">
        <div class="footer-copyright">© <a href="http://harshdeephura.com" target="_blank">Harshdeep Singh Hura</a>.<br>Todos los derechos reservados.</div>
      </footer>
    </div>
  </div>




  <script src="../assets/js/global.js"></script>




</body></html>
