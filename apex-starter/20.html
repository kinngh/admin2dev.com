<html lang="fr-FR"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Cours de démarrage Apex | Admin2Dev</title>
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@500&amp;family=Spartan:wght@500;600;700&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Muli:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../assets/css/stylesheet.css">

  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

  <meta property="og:site_name" content="Admin2Dev">

  <meta property="og:title" content="Scheduled Apex Class"> <!-- Content Title-->
  <meta property="og:description" content="Learn the basics of scheduling an apex class to run at a later time and date"> <!-- Content Description -->
  <meta property="og:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:url" content="https://admin2dev.com/">


  <meta property="article:author" content="https://twitter.com/kinngh">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Scheduled Apex Class"> <!-- Twitter Title -->
  <meta name="twitter:description" content="Learn the basics of scheduling an apex class to run at a later time and date"> <!-- Twitter description -->
  <meta name="twitter:url" content="https://admin2dev.com">
  <meta name="twitter:label1" content="Written by">
  <meta name="twitter:data1" content="Harshdeep Singh Hura">
  <meta name="twitter:label2" content="Filed under">
  <meta name="twitter:data2" content="Apex Tutorials">
  <meta name="twitter:site" content="@kinngh">
  <meta name="twitter:creator" content="@kinngh">
  <meta name="twitter:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-112097931-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'UA-112097931-2');
</script><script async src="https://hm-ackee.herokuapp.com/tracker.js" data-ackee-server="https://hm-ackee.herokuapp.com" data-ackee-domain-id="e6e2d901-0aed-483b-bbdf-074952248f20"></script>

</head>

<body id="myBody" class="global-hash-post-card-amber global-hash-post-card-apricot global-hash-post-card-aqua global-hash-post-card-coral global-hash-post-card-cream global-hash-post-card-green global-hash-post-card-purple global-hash-post-card-raspberry global-hash-post-card-sky is-loaded">
  <div class="global-wrap">
    <div class="global-content">
      <header class="header-section">
        <div class="header-wrap">
          <div class="header-logo">
            <a href="../index.html" class="is-image">
              <img src="../images/logo.png" alt="Admin2Dev">
            </a>
          </div>
          <div class="header-nav">
            <input id="toggle" class="header-checkbox" type="checkbox">
            <label class="header-toggle" for="toggle">
              <span>
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
              </span>
            </label>
            <nav>
              <ul>
                <li><a href="../index.html">Accueil</a></li>
                <li><a href="../learn/index.html">Apprendre</a></li>
<li><a href="../tools/index.html">Outils</a></li>
                 <li><a href="../sponsor/index.html">Commanditaire</a></li>
                <li class="header-nav-dropdown">
                  <svg role="img" viewBox="0 0 20 4" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 4A2 2 0 102.001.001 2 2 0 002 4zm8 0a2 2 0 10.001-3.999A2 2 0 0010 4zm8 0a2 2 0 10.001-3.999A2 2 0 0018 4z"></path></svg>
                  <ul>
                    <li><a href="../about/index.html">À propos</a></li><li><a href="../terms.html">Conditions d'utilisation</a></li>
                    <li><a href="../privacy.html">Politique de confidentialité</a></li>
                  </ul>
                </li>
              </ul>
              <ul>
                <li class="signup global-button"><a href="https://discord.gg/5ndr5F8" target="_blank">Rejoignez la communauté</a></li>
                <li class="signin"><a onclick="darkMode()" id="darkModeText">Mode sombre</a></li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main class="global-main">
        <article class="post-section">
          <div class="post-header item is-hero is-page is-first post no-image page">
            <div class="item-container global-color">
              <div class="item-content">
                <h2 class="item-title">Classe Apex programmée</h2>
              </div>
            </div>
          </div>
          <div class="post-content">
            <p>La plupart d'entre nous ont une routine matinale, qu'il s'agisse de se réveiller tôt et de prendre le petit déjeuner pour toute la famille et de partir au travail ou de se réveiller 5 minutes avant de partir et prendre un café comme petit déjeuner et de partir à la hâte. Certaines activités doivent se dérouler régulièrement et même au travail, il peut s'agir d'envoyer un courriel avec la mise à jour d'aujourd'hui sur les opportunités, ou de statistiques mensuelles sur les revenus ou de rapports annuels sur la performance de l'entreprise. Pour automatiser notre code, nous utilisons <em>Scheduled Apex</em>.</p>
            <p>Comme son nom l'indique, Scheduled Apex exécute une tâche à des délais spécifiques tels que définis par le développeur. Une classe planifiée implémente <em>Schedulable </em>et dispose d'une méthode <code>execute()</code>. Jetons un coup d'œil à la syntaxe :</p>
            <pre><code>global class SomeClass implements Schedulable {
                global void execute(SchedulableContext ctx) {
                    //Code Here
                }
            }</code></pre>
            <ul>
              <li>Une classe de calendrier est toujours<code>global</code></li>
              <li>La classe doit implémenter<code>Schedulable</code></li>
              <li>La classe doit avoir une méthode <code>execute()</code>.</li>
              <li>The <code>SchedulableContext ctx</code> is just like the Batch Class' <code>Database.BatchableContext bc</code>, it is the jobID of the schedule class.</li>
            </ul>
            <p>C'est une bonne pratique d'appeler votre classe batch / classe Apex de votre classe Schedule au lieu de la remplir de code. Appelons une classe de lots :</p>
            <pre><code>global class ClassSchedule implements Schedulable {
                global void execute(SchedulableContext ctx) {
                    //Code Here
                    BatchClass tester = new BatchClass();
                    Database.executeBatch(tester);
                }
            }</code></pre>
            <p>We made a new class called <code>ClassSchedule</code> that implements <code>Schedulable</code> and called our batch class from the <code>execute()</code> method. Nice and simple. Now let's schedule it.</p>
            <p>Lors de la planification de la classe, elle s'exécute sur le <em>fuseau horaire de l'utilisateur qui l'exécute</em>, et pour la plupart des parties, c'est le fuseau horaire du développeur.</p>
            <p>Pour planifier une classe, nous faisons d'abord une nouvelle instance.</p>
            <pre><code>ClassSchedule schClass = new ClassSchedule();</code></pre>
            <p>Now, we setup time using a very specific format.
              <code>Seconds Minutes Hours Day_Of_Month Month Day_Of_Week Optional_Year</code>.</p>
            <p>Voici le balisage sur les valeurs :</p>
            <div class="responsive-table">
              <table>
                <thead>
                  <tr>
                    <th>Nom</th>
                    <th>Valeurs</th>
                    <th>Personnages spéciaux</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Secondes</td>
                    <td>0–59</td>
                    <td>Aucun</td>
                  </tr>
                  <tr>
                    <td>Procès-verbal</td>
                    <td>0–59</td>
                    <td>Aucun</td>
                  </tr>
                  <tr>
                    <td>Heures</td>
                    <td>0-23</td>
                    <td>Aucun</td>
                  </tr>
                  <tr>
                    <td>Jour du mois</td>
                    <td>1-31</td>
                    <td>, - * ? / L W</td>
                  </tr>
                  <tr>
                    <td>Mois</td>
                    <td>1-12 ou trois premières lettres de mois (JAN - DEC)</td>
                    <td>, - * /</td>
                  </tr>
                  <tr>
                    <td>Jour de la semaine</td>
                    <td>1-7 ou Les trois premières lettres du jour (DUN - SAT)</td>
                    <td>, - * ? / L #</td>
                  </tr>
                  <tr>
                    <td>année_optionnelle</td>
                    <td>nul ou 1970-2099</td>
                    <td>, - * /</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>Répartition des caractères spéciaux :</p>
            <div class="responsive-table">
              <table>
                <thead>
                  <tr>
                    <th>Caractère spécial</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>,</td>
                    <td>Delimits values. For example, use <code>JAN, MAR, APR</code> to specify more than one month.</td>
                  </tr>
                  <tr>
                    <td>-</td>
                    <td>Specifies a range. For example, use <code>JAN-MAR</code> to specify more than one month.</td>
                  </tr>
                  <tr>
                    <td>*</td>
                    <td>Spécifie toutes les valeurs. Par exemple, si Month est spécifié comme <code>*</code>, le travail est planifié pour chaque mois.</td>
                  </tr>
                  <tr>
                    <td>?</td>
                    <td>Specifies no specific value. This is only available for <code>Day_of_month</code>and <code>Day_of_week</code>, and is generally used when specifying a value for one and not the other.</td>
                  </tr>
                  <tr>
                    <td>/</td>
                    <td>Specifies increments. The number before the slash specifies when the intervals will begin, and the number after the slash is the interval amount. For example, if you specify <code>1/5</code> for Day_of_month, the Apex class
                      runs every fifth day of the month, starting on the first of the month.</td>
                  </tr>
                  <tr>
                    <td>L</td>
                    <td>Specifies the end of a range (last). This is only available for <code>Day_of_month</code> and <code>Day_of_week</code>. When used with Day of month, L always means the last day of the month, such as January 31, February 29 for
                      leap years, and so on. When used with Day_of_week by itself, it always means 7 or SAT. When used with a Day_of_week value, it means the last of that type of day in the month. For example, if you specify 2L, you are specifying
                      the last Monday of the month. Do not use a range of values with L as the results might be unexpected.</td>
                  </tr>
                  <tr>
                    <td>W</td>
                    <td>Specifies the nearest weekday (Monday-Friday) of the given day. This is only available for <code>Day_of_month</code>. For example, if you specify <code>20W</code>, and the 20th is a Saturday, the class runs on the 19th. If you
                      specify 1W, and the first is a Saturday, the class does not run in the previous month, but on the third, which is the following Monday. Use the L and W together to specify the last weekday of the month.</td>
                  </tr>
                  <tr>
                    <td>#</td>
                    <td>Spécifie le nième jour du mois, au format weekday#day_of_month. Ceci n'est disponible que pour le jour de la semaine. Le numéro avant le # spécifie le jour de la semaine (SUN-SAT). Le numéro après le # spécifie le jour du mois. Par exemple, spécifier 2#2 signifie que la classe s'exécute le deuxième lundi de chaque mois.</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>Comprendre les tableaux pourrait être un peu difficile, prenons donc quelques exemples :</p>
            <div class="responsive-table">
              <table>
                <thead>
                  <tr>
                    <th>Expression</th>
                    <th>Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><code>0 0 13 * * ?</code></td>
                    <td>La classe se déroule tous les jours à 13 heures.</td>
                  </tr>
                  <tr>
                    <td><code>0 0 22 ? * 6L</code></td>
                    <td>Le cours a lieu le dernier vendredi de chaque mois à 22 heures.</td>
                  </tr>
                  <tr>
                    <td><code>0 0 10 ? * MON-FRI</code></td>
                    <td>Le cours se déroule du lundi au vendredi à 10 heures.</td>
                  </tr>
                  <tr>
                    <td><code>0 0 20 * * ? 2010</code></td>
                    <td>La classe se déroule tous les jours à 20 heures pendant l'année 2010.</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>J'écris ceci à 3 h 52 et je veux programmer mon cours pour qu'il fonctionne à 4 heures du matin tous les jours</p>
            <pre><code>String sch = '0 0 4 * * ?';</code></pre>
            <ul>
              <li>First two values denoting seconds and horus is <code>0</code> and the third value is <code>4</code> so that means the time is <code>04:00</code> or 4AM.</li>
              <li>The next two values are <code>*</code> denoting we want Day_of_the month and Month to be <em>all</em> values, so 1st through 31st, Jan to Dec.</li>
              <li>Le jour de la semaine est un <code>?</code> indiquant que nous ne voulons pas spécifier de valeur <em>parce que nous avons déjà spécifié des valeurs pour notre valeur day_of_month, ce qui ne nécessite donc pas de valeur</em></li>
              <li>L'année est omise parce qu'il s'agit d'une valeur facultative.</li>
            </ul>
            <p>This might take some time to understand and I still refer to this chart and spend a solid minute writing <em>when</em> to run so don't worry if you don't get it right away. Now that we have <em>what</em> and <em>when</em> to run, let's
              actually execute it. To do this, we use the <code>System.schedule()</code> class method that takes three parameters:</p>
            <ul>
              <li>Nom (chaîne) de la tâche.</li>
              <li>Heure (chaîne) appelée temps de Cron.</li>
              <li>Catégorie prévue (variable).</li>
            </ul>
            <p>Tout comme notre exécution de classe batch, nous enregistrons l'ID dans une variable. écrivons tout cela ensemble dans une fenêtre Anon Exec :</p>
            <pre><code>ClassSchedule classer = new ClassSchedule();
            String sch = '0 0 4 * * ?'; //run everyday at 4
            String jobId = system.schedule('classScheduler', sch, classer);
            System.debug(jobId);</code></pre>
            <p>Après l'exécution de notre code, rendez-vous sur Configuration et recherchez des <em>travaux planifiés </em>et vous remarquerez qu'il y a un nouveau travail prévu pour l'heure que vous avez spécifiée ! (J'ai couru le mien à 3 h 55 parce que j'étais agité.)</p>
            <figure class="kg-card kg-width-full kg-card-hascaption"><img src="../images/apex/20/1.png" width="100%" alt="Classe planifiée dans l'installation">
            </figure>
            <p>Il y a une option de suppression ici pour supprimer le travail planifié. Il est possible de reprogrammer la classe à partir du code, mais j'ai vu des développeurs expérimentés supprimer le travail et en planifier un nouveau pour la classe afin d'éviter toute confusion. Maintenant que nous savons comment écrire une classe de planification, écrivons une classe de test pour elle.</p>
            <h2>Classe d'essai</h2>
            <p>Personnellement, écrire une classe de test pour la classe planifiée ressemble à une formalité simplement parce que la plupart des cours programmés que j'ai écrits au cours de la dernière année ont appelé une classe par lots et que ces classes avaient déjà des tests écrits, mais puisque nous visons toujours une couverture de code à 100 %, nous avons juste besoin d'appeler la classe planifiée une fois. J'ai également vu des développeurs suivre la même pratique.</p>
            <p>For this, we need to define a <em>Time</em> string, but call the Scheduled class inside the <code>Test.startTest()</code> and <code>Test.stopTest()</code> because <em>this forces the scheduled class to run immediately on the test
                database</em> because we really don't want to wait for testing it.</p>
            <pre><code>@isTest
            public class ClassScheduleTest {
                public static String sch_test = '0 32 4 * * ?'; //define time

                static testmethod void testerMethod(){

                    Test.startTest();
                    ClassSchedule tester = new ClassSchedule();
                    String jobId = System.schedule('Test Class', sch_test, tester);
                    Test.stopTest();


                }
            }</code></pre>
            <p>Les classes planifiées ont certaines limitations dont nous discuterons lorsque nous examinerons la réalisation d'appels HTTP à partir de classes Apex.</p>
            <h1>Résumé</h1>
            <ul>
              <li>Les classes planifiées sont exécutées dans le délai défini par le développeur.</li>
              <li>La classe s'exécute toujours en fonction du fuseau horaire de l'utilisateur</li>
              <li>L'écriture de classes de test pour les classes planifiées est pour la plupart redondante et une approche pratique consiste à écrire une classe de test pour les classes qu'elle appelle et un test éponyme pour ladite classe planifiée juste pour obtenir une couverture de code à 100 %.</li>
            </ul>

            <a href="21.html" class="global-button">Jour 21 : API réseau et REST</a>
          </div>
        </article>

      </main>
      <footer class="footer-section global-footer">
        <div class="footer-copyright">© <a href="http://harshdeephura.com" target="_blank">Harshdeep Singh Hura</a>.<br>Tous droits réservés.</div>
      </footer>
    </div>
  </div>




  <script src="../assets/js/global.js"></script>




</body></html>
