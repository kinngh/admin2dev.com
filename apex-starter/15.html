<html lang="fr-FR"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Cours de démarrage Apex | Admin2Dev</title>
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@500&amp;family=Spartan:wght@500;600;700&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Muli:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../assets/css/stylesheet.css">

  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

  <meta property="og:site_name" content="Admin2Dev">

  <meta property="og:title" content="Batch Apex Test"> <!-- Content Title-->
  <meta property="og:description" content="Test your knowledge on what you've learnt"> <!-- Content Description -->
  <meta property="og:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:url" content="https://admin2dev.com/">


  <meta property="article:author" content="https://twitter.com/kinngh">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Batch Apex Test"> <!-- Twitter Title -->
  <meta name="twitter:description" content="Test your knowledge on what you've learnt"> <!-- Twitter description -->
  <meta name="twitter:url" content="https://admin2dev.com">
  <meta name="twitter:label1" content="Written by">
  <meta name="twitter:data1" content="Harshdeep Singh Hura">
  <meta name="twitter:label2" content="Filed under">
  <meta name="twitter:data2" content="Apex Tutorials">
  <meta name="twitter:site" content="@kinngh">
  <meta name="twitter:creator" content="@kinngh">
  <meta name="twitter:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-112097931-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'UA-112097931-2');
</script><script async src="https://hm-ackee.herokuapp.com/tracker.js" data-ackee-server="https://hm-ackee.herokuapp.com" data-ackee-domain-id="b76d74a9-da14-46a7-b30a-596c57329e5b"></script>

</head>

<body id="myBody" class="global-hash-post-card-amber global-hash-post-card-apricot global-hash-post-card-aqua global-hash-post-card-coral global-hash-post-card-cream global-hash-post-card-green global-hash-post-card-purple global-hash-post-card-raspberry global-hash-post-card-sky is-loaded">
  <div class="global-wrap">
    <div class="global-content">
      <header class="header-section">
        <div class="header-wrap">
          <div class="header-logo">
            <a href="../index.html" class="is-image">
              <img src="../images/logo.png" alt="Admin2Dev">
            </a>
          </div>
          <div class="header-nav">
            <input id="toggle" class="header-checkbox" type="checkbox">
            <label class="header-toggle" for="toggle">
              <span>
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
              </span>
            </label>
            <nav>
              <ul>
                <li><a href="../index.html">Accueil</a></li>
                <li><a href="../learn/index.html">Apprendre</a></li>
<li><a href="../tools/index.html">Outils</a></li>
                 <li><a href="../sponsor/index.html">Commanditaire</a></li>
                <li class="header-nav-dropdown">
                  <svg role="img" viewBox="0 0 20 4" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 4A2 2 0 102.001.001 2 2 0 002 4zm8 0a2 2 0 10.001-3.999A2 2 0 0010 4zm8 0a2 2 0 10.001-3.999A2 2 0 0018 4z"></path></svg>
                  <ul>
                    <li><a href="../about/index.html">À propos</a></li><li><a href="../terms.html">Conditions d'utilisation</a></li>
                    <li><a href="../privacy.html">Politique de confidentialité</a></li>
                  </ul>
                </li>
              </ul>
              <ul>
                <li class="signup global-button"><a href="https://discord.gg/5ndr5F8" target="_blank">Rejoignez la communauté</a></li>
                <li class="signin"><a onclick="darkMode()" id="darkModeText">Mode sombre</a></li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main class="global-main">
        <article class="post-section">
          <div class="post-header item is-hero is-page is-first post no-image page">
            <div class="item-container global-color">
              <div class="item-content">
                <h2 class="item-title">Test d'apex par lots</h2>
              </div>
            </div>
          </div>
          <div class="post-content">

            <p>Ce test rapide est fait pour tester votre compréhension de base de Batch Apex.</p>
            <ul>
              <li>Vous pouvez regarder la syntaxe, les points bonus si vous ne le faites pas.</li>
              <li>Idéalement, le test ne devrait pas prendre plus de 15 minutes à résoudre.</li>
              <li>Tous les critères doivent être remplis.</li>
              <li>La réponse est disponible sur <a href="https://github.com/Admin2Dev/answers" target="_blank">Admin2Dev GitHub Repo</a>.</li>
              <li>La réponse et la ventilation complète du programme sont disponibles à la fin de cette page.</li>
            </ul>
            <h2>Le test</h2>
            <h3>Question</h3>
            <ul>
              <li>Insert 250 contacts with the last name "Test n" where n is a number starting from 1. For reference, the names should look like <code>Test 1</code>, <code>Test 2</code> .. .<code>Test 250</code>.</li>
              <li>If a Contact with the last name <code>DeleteBatch</code> is created, it should run a Batch Apex Class that deletes all contacts with the last name "Test n" where n is a number.</li>
              <li>Lorsque l'Apex par lots termine son exécution, il devrait mettre à jour la description du contact "Supprimer" avec "Enregistrets supprimés avec IDJobID" où JobID devrait être l'ID de la classe Apex par lots.</li>
            </ul>
            <h5>Conseil</h5>
            <ul>
              <li>Use <code>getJobID()</code> method on <code>Database.batchableContext</code> variable to get the Job ID.</li>
              <li>Use the escape character <code>\</code> to add <code>'</code> to your Strings. So to write <code>'Test'</code>, you have to write <code> \'Test\'</code> instead.</li>
              <li>Les modifications peuvent ne pas être visibles instantanément. Donnez-le environ 5 minutes avant de voir les contacts supprimés et les mises à jour de la description.</li>
            </ul>
            <hr>
            <blockquote>
              <p>Démarrez une minuterie et notez combien de temps vous prenez pour résoudre. Idéalement, cela devrait prendre environ 15 minutes, mais ne vous inquiétez pas si vous passez par-dessus bord.</p>
            </blockquote>
            <hr>
            <h2>Réponse</h2>
            <h3>Insertion de 250 enregistrements</h3>
            <ul>
              <li>Vous pouvez soit créer une classe et l'appeler à partir de la fenêtre Anon Exec, soit insérer directement 250 enregistrements sans classes.</li>
            </ul>
            <pre><code>List&lt;Contact&gt; finalList = new List&lt;Contact&gt;();

for(Integer i = 1; i&lt;=250; i++){
    Contact con = new Contact();
    con.lastName = 'Test ' + i;
    finalList.add(con);
}
insert finalList;

System.debug('Inserted ' + finalList.size() + ' records.');</code></pre>
            <h3>Lot Apex</h3>
            <ul>
              <li>Ma classe de lots s'appelle <code>batchDeleter</code>.</li>
            </ul>
            <pre><code>global class batchDeleter implements Database.Batchable&lt;sObject&gt; {

    global Database.QueryLocator start(Database.BatchableContext bc) {
        return Database.getQueryLocator('SELECT Id, LastName FROM Contact WHERE LastName LIKE \'Test%\'');
    }

    global void execute(Database.BatchableContext bc, List&lt;sObject&gt; deleteList){
        delete deleteList;
    }
    global void finish(Database.BatchableContext bc){
        List&lt;Contact&gt; con = [SELECT Id, LastName FROM Contact WHERE LastName = 'DeleteBatch' LIMIT 1];
        List&lt;Contact&gt; finalList = new List&lt;Contact&gt;();
        for (Contact iterator: con){
            iterator.Description = 'Deleted records with ID ' + bc.getJobId();
            finalList.add(iterator);
        }
        update finalList;

    }
}</code></pre>
            <ul>
              <li>First we return all values that have Last Name <code>Test%</code> where <code>%</code> is a wildcard.</li>
              <li>Dans la méthode d'exécution, nous supprimons simplement la liste entière.</li>
              <li>Dans la méthode de finition, nous sélectionnons le contact 'DeleteBatch' et pour être vraiment sûrs d'obtenir seulement 1 valeur, nous utilisons le mot-clé <code>Limit</code>.</li>
              <li>Maintenant, nous itérisons sur notre liste et mettons à jour sa description pour qu'elle corresponde à l'identifiant de la tâche par lots.<ul>
                  <li><code>bc</code> comes from the method parameter <code>Database.BatchableContext bc</code> and running <code>.getJobId()</code> returns the ID.</li>
                </ul>
              </li>
              <li>Ensuite, les valeurs sont validées dans la base de données à l'aide de l'instruction <code>update</code>.</li>
            </ul>
            <h3>Déclencheur</h3>
            <ul>
              <li>Nous voulons que la classe de lot soit exécutée lorsque l'enregistrement est terminé l'insertion, donc l'écriture d'un déclencheur avec une classe d'aide est le seul moyen de contrôler l'exécution de notre classe batch.</li>
            </ul>
            <h4>Fichier de déclenchement</h4>
            <pre><code>trigger LastName on Contact(after insert){
    if (Trigger.isAfter){
        if (Trigger.isInsert){
            LastNameHelper.deleteContacts(trigger.new);
        }
    }
}</code></pre>
            <h4>Fichier d'aide Tigger</h4>
            <pre><code>public class LastNameHelper{

    public static void deleteContacts(List&lt;Contact&gt; newList){

        for(Contact iterator: newList){
            if (iterator.LastName == 'DeleteBatch'){
                batchDeleter runBatch = new batchDeleter();
                Database.executeBatch(runBatch);

            }
        }

    }
}</code></pre>
            <ul>
              <li>In our Helper Class, every time a new contact is inserted we use <code>Trigger.new</code> to pass all records, and in the helper class check for last name. If the last name matches our condition, we run the Batch Class.</li>
            </ul>
            <a href="16.html" class="global-button">Jour 16 : SOQL avancé</a>
          </div>
        </article>

      </main>
      <footer class="footer-section global-footer">
        <div class="footer-copyright">© <a href="http://harshdeephura.com" target="_blank">Harshdeep Singh Hura</a>.<br>Tous droits réservés.</div>
      </footer>
    </div>
  </div>




  <script src="../assets/js/global.js"></script>




</body></html>
