<html lang="fr-FR"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Cours de démarrage Apex | Admin2Dev</title>
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@500&amp;family=Spartan:wght@500;600;700&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Muli:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../assets/css/stylesheet.css">

  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

  <meta property="og:site_name" content="Admin2Dev">

  <meta property="og:title" content="Database Class Methods"> <!-- Content Title-->
  <meta property="og:description" content="Learn the basics of the Database Class and it's Methods"> <!-- Content Description -->
  <meta property="og:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:url" content="https://admin2dev.com/">


  <meta property="article:author" content="https://twitter.com/kinngh">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Database Class Methods"> <!-- Twitter Title -->
  <meta name="twitter:description" content="Learn the basics of the Database Class and it's Methods"> <!-- Twitter description -->
  <meta name="twitter:url" content="https://admin2dev.com">
  <meta name="twitter:label1" content="Written by">
  <meta name="twitter:data1" content="Harshdeep Singh Hura">
  <meta name="twitter:label2" content="Filed under">
  <meta name="twitter:data2" content="Apex Tutorials">
  <meta name="twitter:site" content="@kinngh">
  <meta name="twitter:creator" content="@kinngh">
  <meta name="twitter:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-112097931-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'UA-112097931-2');
</script><script async src="https://hm-ackee.herokuapp.com/tracker.js" data-ackee-server="https://hm-ackee.herokuapp.com" data-ackee-domain-id="e6e2d901-0aed-483b-bbdf-074952248f20"></script>

</head>

<body id="myBody" class="global-hash-post-card-amber global-hash-post-card-apricot global-hash-post-card-aqua global-hash-post-card-coral global-hash-post-card-cream global-hash-post-card-green global-hash-post-card-purple global-hash-post-card-raspberry global-hash-post-card-sky is-loaded">
  <div class="global-wrap">
    <div class="global-content">
      <header class="header-section">
        <div class="header-wrap">
          <div class="header-logo">
            <a href="../index.html" class="is-image">
              <img src="../images/logo.png" alt="Admin2Dev">
            </a>
          </div>
          <div class="header-nav">
            <input id="toggle" class="header-checkbox" type="checkbox">
            <label class="header-toggle" for="toggle">
              <span>
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
              </span>
            </label>
            <nav>
              <ul>
                <li><a href="../index.html">Accueil</a></li>
                <li><a href="../learn/index.html">Apprendre</a></li>
<li><a href="../tools/index.html">Outils</a></li>
                 <li><a href="../sponsor/index.html">Commanditaire</a></li>
                <li class="header-nav-dropdown">
                  <svg role="img" viewBox="0 0 20 4" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 4A2 2 0 102.001.001 2 2 0 002 4zm8 0a2 2 0 10.001-3.999A2 2 0 0010 4zm8 0a2 2 0 10.001-3.999A2 2 0 0018 4z"></path></svg>
                  <ul>
                    <li><a href="../about/index.html">À propos</a></li><li><a href="../terms.html">Conditions d'utilisation</a></li>
                    <li><a href="../privacy.html">Politique de confidentialité</a></li>
                  </ul>
                </li>
              </ul>
              <ul>
                <li class="signup global-button"><a href="https://discord.gg/5ndr5F8" target="_blank">Rejoignez la communauté</a></li>
                <li class="signin"><a onclick="darkMode()" id="darkModeText">Mode sombre</a></li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main class="global-main">
        <article class="post-section">
          <div class="post-header item is-hero is-page is-first post no-image page">
            <div class="item-container global-color">
              <div class="item-content">
                <h2 class="item-title">Méthodes de classe de base de données</h2>
              </div>
            </div>
          </div>
          <div class="post-content">

            <h2>Méthodes de classe de base de données</h2>
            <p>Les méthodes de classe de base de données sont d'autres façons d'utiliser les instructions DML, sauf que les méthodes de classe de base de données offrent plus de fonctionnalité et de flexibilité.</p>
            <div class="responsive-table">
              <table>
                <thead>
                  <tr>
                    <th>Déclarations DML</th>
                    <th>Méthodes de classe de base de données</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Les mises à jour partielles ne sont pas autorisées</td>
                    <td>Permet des mises à jour partielles</td>
                  </tr>
                  <tr>
                    <td>Aucun moyen d'obtenir la liste des enregistrements réussis / échoués</td>
                    <td>Des méthodes sont disponibles pour obtenir la liste des enregistrements qui ont été insérés ou échoués.</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>L'utilisation des méthodes de classe de base de données nécessite une connaissance des classes intégrées.</p>
            <ul>
              <li>Classe de base de données</li>
              <li>Classe SaveResult</li>
              <li>Classe d'erreur</li>
            </ul>
            <h2>Classe de base de données</h2>
            <p>Les méthodes de Database Class vous permettent de manipuler les données dans la base de données de l'organisation et de procéder à des mises à jour partielles, ce qui signifie que vous pouvez manipuler plusieurs enregistrements d'un objet et que l'opération se ferait même si certains échouaient. La syntaxe est"</p>
            <pre><code>Database.statement(Record_Or_List, allOrNone);
</code></pre>
            <ul>
              <li><code>Database</code>est le mot-clé</li>
              <li><code>statement</code> is the operation we are doing on a single record or list. This can be <code>insert,</code> <code>update</code>, <code>upsert</code>,
                <code>delete</code> or<code>undelete</code></li>
              <li><code>Single_Or_List</code>peut être un seul enregistrement en cours d'insertion ou une liste d'objets.</li>
              <li><code>allOrNone</code> can be either <code>true</code> or <code>false</code> to indicate if the records should be operated on despite some of them failing.</li>
            </ul>
            <p>Insérons maintenant 2 enregistrements dans l'objet de contact, l'un qui réussit et l'autre échoue.</p>
            <pre><code>List&lt;Contact&gt; finalList = new List&lt;Contact&gt;();

Contact con = new Contact();
con.lastName = 'Smith';
finalList.add(con);

Contact failCon = new Contact();
failCon.firstName = 'John';
finalList.add(failCon);

Database.insert(finalList, true);
</code></pre>
            <p>Lorsque ce code est exécuté, il génère une erreur indiquant que Nom de famille est un champ obligatoire, mais si la dernière instruction est passée à false, il insère les valeurs qui peuvent être insérées et omet le reste</p>
            <pre><code>Database.insert(finalList, false);
</code></pre>
            <p>On opening our console log and entering “Debug Only” section, there is no log. This is because we need the <code>SaveResult</code> class to save the results.</p>
            <h2>Enregistrer le résultat</h2>
            <p>SaveResult class is the result of an insert or update operation returned by the Database Class. Every Database operation returns an array (arrays are like List, but use
              <code>[ ]</code> instead of <code>&lt;&gt;</code>) of SaveResult. To use it, we just save the result of a Database operation into a <code>Database.SaveResult[] variableName</code>. Let’s add this to our code and loop over it:</p>
            <pre><code>List&lt;Contact&gt; finalList = new List&lt;Contact&gt;();

Contact con = new Contact();
con.lastName = 'Smith';
finalList.add(con);

Contact failCon = new Contact();
failCon.firstName = 'John';
finalList.add(failCon);

Database.SaveResult[] resultList = Database.insert(finalList, false); //Allow partial updates

for (Database.SaveResult iterator: resultList){
    System.debug(iterator);
}</code></pre>
            <p>Vous obtiendrez ce qui suit dans vos journaux de débogage uniquement :</p>
            <pre><code>01:53:17:158 USER_DEBUG [14]|DEBUG|Database.SaveResult[getErrors=();getId=0036F00003XBWVJQA5;isSuccess=true;]

01:53:17:167 USER_DEBUG [14]|DEBUG|Database.SaveResult[getErrors=(Database.Error[getFields=(LastName);getMessage=Required fields are missing:[LastName];getStatusCode=REQUIRED_FIELD_MISSING;]);getId=null;isSuccess=false;]</code></pre>
            <p>You will notice the successful field has <code>getErrors</code>, <code>getId</code> and <code>isSuccess</code> fields, which can actually be used in our code to filter out
              successful results and get their IDs, and only output the failed fields. Let’s update our for loop to reflect this change and pretty up our logs:</p>
            <pre><code>for (Database.SaveResult iterator: resultList){
    if (iterator.isSuccess()){
        System.debug('Successfuly inserted: ' + iterator.getID());
    }
    else {
        System.debug(iterator);
    }
}</code></pre>
            <p>Super ! maintenant, pour traiter les erreurs, nous utilisons les méthodes disponibles dans la classe <code>Error</code>.</p>
            <h2>Erreur</h2>
            <p>La classe Error est utilisée pour le signalement des erreurs et dispose de 3 méthodes :</p>
            <ul>
              <li><code>getFields()</code>pour obtenir un tableau de champs qui ont échoué</li>
              <li><code>getMessage()</code>pour savoir pourquoi l'enregistrement a échoué</li>
              <li><code>getStatusCode()</code>pour obtenir le code d'état de l'erreur</li>
            </ul>
            <p>Ceci est utilisé en combinaison avec la classe de base de données et c'est la méthode <code>.getErrors()</code>.</p>
            <p>Ajoutons cela dans notre boucle for</p>
            <pre><code>for (Database.SaveResult iterator: resultList){
    if (iterator.isSuccess()){
        System.debug('Successfuly inserted: ' + iterator.getID());
    }
    else {
        for (Database.error errorIterator: iterator.getErrors()){
            System.debug(errorIterator.getStatusCode() + ' ' + errorIterator.getMessage() );
            System.debug('The following fields were affected: ' + errorIterator.getFields());
        }
    }
}</code></pre>
            <p>Le journal indique maintenant :</p>
            <pre><code>02:10:12:126 USER_DEBUG [15]|DEBUG|Successfuly inserted: 0036F00003XBWWvQAP

02:10:12:143 USER_DEBUG [19]|DEBUG|REQUIRED_FIELD_MISSING Required fields are missing: [LastName]

02:10:12:143 USER_DEBUG [20]|DEBUG|The following fields were affected: (LastName)
</code></pre>
            <p>Maintenant, les journaux sont beaucoup plus propres et produisent nos erreurs très clairement ! La classe Base de données a d'autres méthodes que nous apprendrons au cours des prochains jours.</p>

            <h1>Résumé</h1>
            <ul>
              <li>Les méthodes de classe de base de données ont des fonctionnalités étendues et permettent des mises à jour partielles</li>
              <li>La classe SaveResult permet d'enregistrer les résultats des opérations de la base de données</li>
              <li>La classe d'erreur permet de naviguer à travers les erreurs</li>
              <li>An Array is similar to a list, with the only exception of <code>[ ]</code> instead of <code>&lt; &gt;</code> </li>
            </ul>





            <a href="10.html" class="global-button">Jour 10 : SOSL et Type Casting</a>
          </div>
        </article>

      </main>
      <footer class="footer-section global-footer">
        <div class="footer-copyright">© <a href="http://harshdeephura.com" target="_blank">Harshdeep Singh Hura</a>.<br>Tous droits réservés.</div>
      </footer>
    </div>
  </div>




  <script src="../assets/js/global.js"></script>




</body></html>
