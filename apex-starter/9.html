<html lang="es-ES"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Curso Apex Starter | Admin2Dev</title>
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@500&amp;family=Spartan:wght@500;600;700&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Muli:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../assets/css/stylesheet.css">

  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

  <meta property="og:site_name" content="Admin2Dev">

  <meta property="og:title" content="Database Class Methods"> <!-- Content Title-->
  <meta property="og:description" content="Learn the basics of the Database Class and it's Methods"> <!-- Content Description -->
  <meta property="og:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:url" content="https://admin2dev.com/">


  <meta property="article:author" content="https://twitter.com/kinngh">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Database Class Methods"> <!-- Twitter Title -->
  <meta name="twitter:description" content="Learn the basics of the Database Class and it's Methods"> <!-- Twitter description -->
  <meta name="twitter:url" content="https://admin2dev.com">
  <meta name="twitter:label1" content="Written by">
  <meta name="twitter:data1" content="Harshdeep Singh Hura">
  <meta name="twitter:label2" content="Filed under">
  <meta name="twitter:data2" content="Apex Tutorials">
  <meta name="twitter:site" content="@kinngh">
  <meta name="twitter:creator" content="@kinngh">
  <meta name="twitter:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-112097931-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'UA-112097931-2');
</script><script async="" src="https://hm-ackee.herokuapp.com/tracker.js" data-ackee-server="https://hm-ackee.herokuapp.com" data-ackee-domain-id="b76d74a9-da14-46a7-b30a-596c57329e5b"></script>

</head>

<body id="myBody" class="global-hash-post-card-amber global-hash-post-card-apricot global-hash-post-card-aqua global-hash-post-card-coral global-hash-post-card-cream global-hash-post-card-green global-hash-post-card-purple global-hash-post-card-raspberry global-hash-post-card-sky global-hash-dark-version is-loaded">
  <div class="global-wrap">
    <div class="global-content">
      <header class="header-section">
        <div class="header-wrap">
          <div class="header-logo">
            <a href="../index.html" class="is-image">
              <img src="../images/logo.png" alt="Admin2Dev">
            </a>
          </div>
          <div class="header-nav">
            <input id="toggle" class="header-checkbox" type="checkbox">
            <label class="header-toggle" for="toggle">
              <span>
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
              </span>
            </label>
            <nav>
              <ul>
                <li><a href="../index.html">Inicio</a></li>
                <li><a href="../learn/index.html">Aprender</a></li>
<li><a href="../tools/index.html">Herramientas</a></li>
                 <li><a href="../sponsor/index.html">Patrocinador</a></li>
                <li class="header-nav-dropdown">
                  <svg role="img" viewBox="0 0 20 4" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 4A2 2 0 102.001.001 2 2 0 002 4zm8 0a2 2 0 10.001-3.999A2 2 0 0010 4zm8 0a2 2 0 10.001-3.999A2 2 0 0018 4z"></path></svg>
                  <ul>
                    <li><a href="../about/index.html">Acerca de</a></li><li><a href="../terms.html">Condiciones del servicio</a></li>
                    <li><a href="../privacy.html">Política de privacidad</a></li>
                  </ul>
                </li>
              </ul>
              <ul>
                <li class="signup global-button"><a href="https://discord.gg/5ndr5F8" target="_blank">Únete a la comunidad</a></li>
                <li class="signin"><a onclick="darkMode()" id="darkModeText">Modo de luz</a></li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main class="global-main">
        <article class="post-section">
          <div class="post-header item is-hero is-page is-first post no-image page">
            <div class="item-container global-color">
              <div class="item-content">
                <h2 class="item-title">Métodos de clase de base de datos</h2>
              </div>
            </div>
          </div>
          <div class="post-content">

            <h2>Métodos de clase de base de datos</h2>
            <p>Los métodos de clase de base de datos son formas alternativas de usar instrucciones DML, excepto que los métodos de clase de base de datos ofrecen más funcionalidad y flexibilidad.</p>
            <div class="responsive-table">
              <table>
                <thead>
                  <tr>
                    <th>Declaraciones DML</th>
                    <th>Métodos de clase de base de datos</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>No se permiten actualizaciones parciales</td>
                    <td>Permite actualizaciones parciales</td>
                  </tr>
                  <tr>
                    <td>No hay manera de obtener una lista de registros exitosos / fallidos</td>
                    <td>Los métodos están disponibles para obtener una lista de los registros que se insertaron o fallaron.</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <p>El uso de métodos de clases de base de datos requiere conocimiento de clases incorporadas.</p>
            <ul>
              <li>Clase de base de datos</li>
              <li>Clase SaveResult</li>
              <li>Clase de error</li>
            </ul>
            <h2>Clase de base de datos</h2>
            <p>Los métodos de Database Class le permiten manipular datos en la base de datos de la organización y permitir actualizaciones parciales, lo que significa que puede manipular varios registros de un objeto y la operación se realizaría incluso si algunos fallan. La sintaxis es"</p>
            <pre><code>Database.statement(Record_Or_List, allOrNone);
</code></pre>
            <ul>
              <li><code>Database</code>es la palabra clave</li>
              <li><code>statement</code> is the operation we are doing on a single record or list. This can be <code>insert,</code> <code>update</code>, <code>upsert</code>,
                <code>delete</code> or<code>undelete</code></li>
              <li><code>Single_Or_List</code>puede ser un solo registro que se inserta o una lista de objetos.</li>
              <li><code>allOrNone</code> can be either <code>true</code> or <code>false</code> to indicate if the records should be operated on despite some of them failing.</li>
            </ul>
            <p>Insertemos ahora 2 registros en el objeto de contacto, uno que sucede y el otro falla.</p>
            <pre><code>List&lt;Contact&gt; finalList = new List&lt;Contact&gt;();

Contact con = new Contact();
con.lastName = 'Smith';
finalList.add(con);

Contact failCon = new Contact();
failCon.firstName = 'John';
finalList.add(failCon);

Database.insert(finalList, true);
</code></pre>
            <p>Cuando se ejecuta este código, lanza un error que indica que Last Name es un campo obligatorio, pero si la última instrucción se cambia a false, inserta los valores que se pueden insertar y omite el resto</p>
            <pre><code>Database.insert(finalList, false);
</code></pre>
            <p>On opening our console log and entering “Debug Only” section, there is no log. This is because we need the <code>SaveResult</code> class to save the results.</p>
            <h2>Guardar resultado</h2>
            <p>SaveResult class is the result of an insert or update operation returned by the Database Class. Every Database operation returns an array (arrays are like List, but use
              <code>[ ]</code> instead of <code>&lt;&gt;</code>) of SaveResult. To use it, we just save the result of a Database operation into a <code>Database.SaveResult[] variableName</code>. Let’s add this to our code and loop over it:</p>
            <pre><code>List&lt;Contact&gt; finalList = new List&lt;Contact&gt;();

Contact con = new Contact();
con.lastName = 'Smith';
finalList.add(con);

Contact failCon = new Contact();
failCon.firstName = 'John';
finalList.add(failCon);

Database.SaveResult[] resultList = Database.insert(finalList, false); //Allow partial updates

for (Database.SaveResult iterator: resultList){
    System.debug(iterator);
}</code></pre>
            <p>Obtendrá lo siguiente en sus registros de Debug Only:</p>
            <pre><code>01:53:17:158 USER_DEBUG [14]|DEBUG|Database.SaveResult[getErrors=();getId=0036F00003XBWVJQA5;isSuccess=true;]

01:53:17:167 USER_DEBUG [14]|DEBUG|Database.SaveResult[getErrors=(Database.Error[getFields=(LastName);getMessage=Required fields are missing:[LastName];getStatusCode=REQUIRED_FIELD_MISSING;]);getId=null;isSuccess=false;]</code></pre>
            <p>You will notice the successful field has <code>getErrors</code>, <code>getId</code> and <code>isSuccess</code> fields, which can actually be used in our code to filter out
              successful results and get their IDs, and only output the failed fields. Let’s update our for loop to reflect this change and pretty up our logs:</p>
            <pre><code>for (Database.SaveResult iterator: resultList){
    if (iterator.isSuccess()){
        System.debug('Successfuly inserted: ' + iterator.getID());
    }
    else {
        System.debug(iterator);
    }
}</code></pre>
            <p>¡Genial! ahora para lidiar con los errores, hacemos uso de los métodos disponibles en la clase <code>Error</code>.</p>
            <h2>Error</h2>
            <p>La clase Error se utiliza para la notificación de errores y tiene 3 métodos:</p>
            <ul>
              <li><code>getFields()</code>para obtener una matriz de campos que falló</li>
              <li><code>getMessage()</code>para saber por qué falló el registro</li>
              <li><code>getStatusCode()</code>para obtener el código de estado del error</li>
            </ul>
            <p>Esto se utiliza en combinación con la clase Database y es el método <code>.getErrors()</code>.</p>
            <p>Añadamos esto en nuestro bucle for</p>
            <pre><code>for (Database.SaveResult iterator: resultList){
    if (iterator.isSuccess()){
        System.debug('Successfuly inserted: ' + iterator.getID());
    }
    else {
        for (Database.error errorIterator: iterator.getErrors()){
            System.debug(errorIterator.getStatusCode() + ' ' + errorIterator.getMessage() );
            System.debug('The following fields were affected: ' + errorIterator.getFields());
        }
    }
}</code></pre>
            <p>El registro ahora dice:</p>
            <pre><code>02:10:12:126 USER_DEBUG [15]|DEBUG|Successfuly inserted: 0036F00003XBWWvQAP

02:10:12:143 USER_DEBUG [19]|DEBUG|REQUIRED_FIELD_MISSING Required fields are missing: [LastName]

02:10:12:143 USER_DEBUG [20]|DEBUG|The following fields were affected: (LastName)
</code></pre>
            <p>¡Ahora los registros son mucho más limpios y producen nuestros errores muy claramente! La clase de Base de Datos tiene más métodos que aprenderemos en el transcurso de los próximos días.</p>

            <h1>Resumen</h1>
            <ul>
              <li>Los métodos de clase de base de datos tienen funcionalidad extendida y permiten actualizaciones parciales</li>
              <li>La clase SaveResult permite guardar los resultados de las operaciones de la base de datos</li>
              <li>La clase Error permite navegar a través de errores</li>
              <li>An Array is similar to a list, with the only exception of <code>[ ]</code> instead of <code>&lt; &gt;</code> </li>
            </ul>





            <a href="10.html" class="global-button">Día 10: SOSL y Type Casting</a>
          </div>
        </article>

      </main>
      <footer class="footer-section global-footer">
        <div class="footer-copyright">© <a href="http://harshdeephura.com" target="_blank">Harshdeep Singh Hura</a>.<br>Todos los derechos reservados.</div>
      </footer>
    </div>
  </div>




  <script src="../assets/js/global.js"></script>




</body></html>
