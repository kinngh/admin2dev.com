<html lang="fr-FR"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Cours de démarrage Apex | Admin2Dev</title>
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@500&amp;family=Spartan:wght@500;600;700&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Muli:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../assets/css/stylesheet.css">

  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

  <meta property="og:site_name" content="Admin2Dev">

  <meta property="og:title" content="REST API Class and Making Snippets"> <!-- Content Title-->
  <meta property="og:description" content="Learn the basics of calling a REST API from an Apex Class and how to make code snippets to save time"> <!-- Content Description -->
  <meta property="og:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:url" content="https://admin2dev.com/">


  <meta property="article:author" content="https://twitter.com/kinngh">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="REST API Class and Making Snippets"> <!-- Twitter Title -->
  <meta name="twitter:description" content="Learn the basics of calling a REST API from an Apex Class and how to make code snippets to save time"> <!-- Twitter description -->
  <meta name="twitter:url" content="https://admin2dev.com">
  <meta name="twitter:label1" content="Written by">
  <meta name="twitter:data1" content="Harshdeep Singh Hura">
  <meta name="twitter:label2" content="Filed under">
  <meta name="twitter:data2" content="Apex Tutorials">
  <meta name="twitter:site" content="@kinngh">
  <meta name="twitter:creator" content="@kinngh">
  <meta name="twitter:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-112097931-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'UA-112097931-2');
</script><script async src="https://hm-ackee.herokuapp.com/tracker.js" data-ackee-server="https://hm-ackee.herokuapp.com" data-ackee-domain-id="b76d74a9-da14-46a7-b30a-596c57329e5b"></script>

</head>

<body id="myBody" class="global-hash-post-card-amber global-hash-post-card-apricot global-hash-post-card-aqua global-hash-post-card-coral global-hash-post-card-cream global-hash-post-card-green global-hash-post-card-purple global-hash-post-card-raspberry global-hash-post-card-sky is-loaded">
  <div class="global-wrap">
    <div class="global-content">
      <header class="header-section">
        <div class="header-wrap">
          <div class="header-logo">
            <a href="../index.html" class="is-image">
              <img src="../images/logo.png" alt="Admin2Dev">
            </a>
          </div>
          <div class="header-nav">
            <input id="toggle" class="header-checkbox" type="checkbox">
            <label class="header-toggle" for="toggle">
              <span>
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
              </span>
            </label>
            <nav>
              <ul>
                <li><a href="../index.html">Accueil</a></li>
                <li><a href="../learn/index.html">Apprendre</a></li>
<li><a href="../tools/index.html">Outils</a></li>
                 <li><a href="../sponsor/index.html">Commanditaire</a></li>
                <li class="header-nav-dropdown">
                  <svg role="img" viewBox="0 0 20 4" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 4A2 2 0 102.001.001 2 2 0 002 4zm8 0a2 2 0 10.001-3.999A2 2 0 0010 4zm8 0a2 2 0 10.001-3.999A2 2 0 0018 4z"></path></svg>
                  <ul>
                    <li><a href="../about/index.html">À propos</a></li><li><a href="../terms.html">Conditions d'utilisation</a></li>
                    <li><a href="../privacy.html">Politique de confidentialité</a></li>
                  </ul>
                </li>
              </ul>
              <ul>
                <li class="signup global-button"><a href="https://discord.gg/5ndr5F8" target="_blank">Rejoignez la communauté</a></li>
                <li class="signin"><a onclick="darkMode()" id="darkModeText">Mode sombre</a></li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main class="global-main">
        <article class="post-section">
          <div class="post-header item is-hero is-page is-first post no-image page">
            <div class="item-container global-color">
              <div class="item-content">
                <h2 class="item-title">Classe d'API REST et création d'extraits</h2>
              </div>
            </div>
          </div>
          <div class="post-content">
            <p>REMARQUE : Cela peut être très confus au début, prenez votre temps pour comprendre ce qui se passe.</p>
            <p>Décomposons ce chapitre en deux parties : Premièrement, nous allons écrire tout le code et appeler une API REST Deuxièmement, nous faisons un modèle pour faire des appels d'API REST afin de pouvoir réutiliser le bloc de code encore et encore.</p>
            <h1>Partie 1</h1>
            <p>Before we even write the code, we need to <code>whitelist</code> the doman we will be making calls to. In our case, we will be running calls to <code>https://admin2dev.com</code> . Head over to <code>Setup</code> and in Quick Find Box
              search for <code>Remote Site</code> and add new remote site.</p>
            <p>Maintenant que le domaine est sur la liste blanche, accédons à notre JSON disponible à l'adresse <a href="https://admin2dev.com/rest/response.json" target="_blank">https://admin2dev.com/rest/response.json </a>. Bien qu'il s'agisse d'un lien statique, c'est exactement ainsi qu'une réponse fonctionnerait. Tout d'abord, faisons un appel GET de Postman et voyons quelle est la réponse :</p>
            <pre><code>{
  	"bird": {
  		"id": 1,
  		"name": "chicken",
  		"food": "wheat",
  		"product": "eggs"
  	}
  }</code></pre>
            <p>Décomposons ce JSON :</p>
            <ul>
              <li>Nous avons 1 objet appelé<code>bird</code>
                <ul>
                  <li>It has 4 values. 1 <code>Integer</code> called <strong>id</strong> and 3 <code>String</code> called <strong>name</strong>, <strong>food</strong> and <strong>product</strong></li>
                </ul>
              </li>
            </ul>
            <p>For this, we first write a class named <code>Bird</code> and declare variables named as they are in the JSON with their respective data types.</p>
            <pre><code>public class responseClass{

  	public class Bird {
          public Integer id;
          public String name, food, product;
      }

  }</code></pre>
            <blockquote>
              <p>Le nom des variables doit correspondre exactement à celles du fichier JSON.</p>
            </blockquote>
            <p>Comme ces valeurs se trouvent à l'intérieur d'un objet, nous devons faire une autre classe qui contient l'objet comme une classe :</p>
            <pre><code>public class responseClass{


      public class JSONResponse {
          public Bird bird;
      }

      public class Bird {
          public Integer id;
          public String name, food, product;
      }
  }</code></pre>
            <p>What we have done here is recreate the JSON in Apex terms. The <code>public Bird bird</code> defines the variable <code>bird</code> as a <code>Bird</code> class type so now it has access to <code>id</code>, <code>name</code>,
              <code>food</code> and <code>product</code>. This is the most important step of dealing with JSON response, as it should be structured and named exactly as the main JSON file. In the background, what we have done in Apex terms is</p>
            <pre><code>class Bird(){
  	Integer Id;
  	String name, food, product;
  }</code></pre>
            <p>I usually name the parent class <code>JSONResponse</code> because that's the class we will be using to navigate our JSON response.</p>
            <p>Maintenant, nous faisons une méthode, où nous construisons et faisons notre requête HTTP :</p>
            <pre><code>Http http = new Http();
  HttpRequest request = new HttpRequest();

  request.setEndpoint('https://admin2dev.com/rest/response.json');
  request.setMethod('GET');</code></pre>
            <p>Now we need to make the request and store it in a <code>HttpResponse</code> type variable:</p>
            <pre><code>HttpResponse response = http.send(request);</code></pre>
            <p>Maintenant, notre classe devrait ressembler à ceci :</p>
            <pre><code>public class responseClass {

      public class JSONResponse {
          public Bird bird;
      }

      public class Bird {
          public Integer id;
          public String name, food, product;
      }

      public static String methodName() {


          Http http = new Http();
          HttpRequest request = new HttpRequest();

          request.setEndpoint('https://admin2dev.com/rest/response.json');
          request.setMethod('GET');

          HttpResponse response = http.send(request);

      }
  }</code></pre>
            <p>Super ! Maintenant que nous avons fait l'appel et enregistré la réponse, nous devons naviguer dans le JSON. Ce processus s'appelle la désérialisation JSON où nous obtenons des valeurs du JSON et le stockons dans des variables.</p>
            <p>Pour cela, nous faisons une nouvelle variable de type JSONResponse et l'on tape la réponse au type JSONResponse (si vous l'avez oublié, jetez un coup d'œil au jour 10).</p>
            <pre><code>JSONResponse result = (JSONResponse) JSON.deserialize(response.getBody(), JSONResponse.class);</code></pre>
            <p>Now we get to our value by using <code>result</code> variable that contains our deserialized JSON, followed by the JSONResponse variable <code>bird</code>, followed by the key we are trying to access:</p>
            <pre><code>return result.bird.name;</code></pre>
            <p>Notre code final devrait ressembler à ceci :</p>
            <pre><code>public class responseClass {

      public class JSONResponse {
          public Bird bird;
      }

      public class Bird {
          public Integer id;
          public String name, food, product;
      }

      public static String methodName() {


          Http http = new Http();
          HttpRequest request = new HttpRequest();
          request.setEndpoint('https://admin2dev.com/rest/response.json');
          request.setMethod('GET');
          HttpResponse response = http.send(request);

          JSONResponse result = (JSONResponse) JSON.deserialize(response.getBody(), JSONResponse.class);
          return result.bird.name;

      }
  }</code></pre>
            <p>Voici donc ce que nous avons fait :</p>
            <ul>
              <li>Made a <code>JSONResponse</code> class that holds the JSON Object</li>
              <li>Fait une classe nommée d'après l'objet JSON (<code>Bird</code>) qui contient les valeurs</li>
              <li>Fait une méthode pour :<ul>
                  <li>Faites d'abord l'appel HTTP</li>
                  <li>Construit une requête HTTP avec <em>quoi </em>et <em>où </em>nous faisons l'appel</li>
                  <li>Stockage de la réponse HTTP</li>
                  <li>Fait une variable qui contient la réponse lorsqu'elle est désérialisée</li>
                  <li>Navigation dans le résultat et retour</li>
                </ul>
              </li>
            </ul>
            <p>Bien que ce soit beaucoup à digérer, transformons-le en un <em>extrait</em>, une sorte de modèle qui peut être réutilisé comme remplir les blancs.</p>
            <h1>Partie 2</h1>
            <p>Il est possible d'éviter à peu près d'écrire autant de code. C'est pourquoi chaque développeur efficace crée son ensemble d'extraits<em> </em>qu'il utilise. Au fil des ans, j'ai personnellement créé des extraits pour mes applications iOS / macOS (Swift), AI (Python) et Apex / Visualforce. Voyons comment transformer ce code spécifique en un extrait :</p>
            <pre><code>public class responseClass {

      public class JSONResponse { //create JSON structure class
      	//Define values as is with data types
      	//Ensure name of the variables matches the JSON keys
      }

  	public static String methodName() {

          //Make the Request and save it

          String requestURL = 'http://url-goes-here.com/';
          String requestType = 'GET'; //GET POST PATCH PUT DELETE

          Http http = new Http();
          HttpRequest request = new HttpRequest();
          request.setEndpoint(requestURL);
          request.setMethod(requestType);
          HttpResponse response = http.send(request);

          // Deserialize based on result type class
          JSONResponse result = (JSONResponse) JSON.deserialize(response.getBody(), JSONResponse.class);
          return result.JSONObject.Key_Name //Replace JSONObject with value from JSONResponse and Key_Name with the key you're accessing in the said JSON

     }
  }</code></pre>
            <p>Now this snippet is a simple copy paste away to making a call to simple JSON File. You'll notice how a lot of the code that we wrote was bunch of code that was <em>as is</em>, meaning we don't really need to remember what we're doing
              here, and can be turned into a <em>template</em> or a <em>snippet</em> to get things done. In this particular example, we only need to update the <code>JSONResponse</code>, <code>requestURL</code>, <code>requestType</code> and the
              <code>return</code> value at the end, which is much simpler than remembering to define HTTP variables and calling and saving responses over and over again.</p>
            <p>Faire des extraits est vraiment important car cela réduit votre charge de travail d'un morceau, vous permettant de réutiliser votre code à travers plusieurs organisations sans avoir à modifier beaucoup. Il est toutefois toujours important de savoir ce que fait chaque ligne de code et de commenter correctement votre code, donc à une date ultérieure, s'il y a des changements dans le fonctionnement d'Apex, il est facile de mettre à jour votre bibliothèque d'extraits.</p>
            <p>I have my snippet library stored and organized in my private repo that I usually refer to, which now is open sourced and available with documentation at <a href="https://github.com/Admin2Dev/apex-snippets" target="_blank">https://github.com/Admin2Dev/apex-snippets</a> that covers commonly used classes along with tests! Feel free to <code>fork</code> the code which allows you to copy the code in your
              github repo and make changes to it!</p>
            <p>Essayons avec une nouvelle réponse JSON ! Voici l'URL : <a href="https://admin2dev.com/rest/response2.json" target="_blank">https://admin2dev.com/rest/response2.json </a>. Utilisez l'extrait ci-dessus pour renvoyer n'importe quelle valeur de la réponse. Si vous êtes coincé, voici le JSON et le code :</p>
            <p>Tout d'abord, nous utilisons Postman pour obtenir le JSON :</p>
            <pre><code>{
  	"animal": {
  		"name": "cow",
  		"food": "grass",
  		"product": "milk"
  	}
  }</code></pre>
            <p>Maintenant, nous copions coller l'extrait<em> </em>et changeons le nom de la classe :</p>
            <pre><code>public class httpResponseClass {

      public class JSONResponse { //create JSON structure class
      	//Define values as is with data types
      	//Ensure name of the variables matches the JSON keys
      }

  	public static String methodName() {

          //Make the Request and save it

          String requestURL = 'http://url-goes-here.com/';
          String requestType = 'GET'; //GET POST PATCH PUT DELETE

          Http http = new Http();
          HttpRequest request = new HttpRequest();
          request.setEndpoint(requestURL);
          request.setMethod(requestType);
          HttpResponse response = http.send(request);

          // Deserialize based on result type class
          JSONResponse result = (JSONResponse) JSON.deserialize(response.getBody(), JSONResponse.class);
          return result.JSONObject.Key_Name //Replace JSONObject with value from JSONResponse and Key_Name with the key you're accessing in the said JSON

     }
  }</code></pre>
            <p>Maintenant, nous construisons notre structure JSON et la stockons</p>
            <pre><code>public class JSONResponse{
  	public Animal animal;
  }
  public class Animal{
  	String name, food, product;
  }</code></pre>
            <p>Now we update the <code>requestURL</code> to <code>https://admin2dev.com/rest/response2.json</code>, <code>JSONObject</code> to <code>animal</code> and <code>KEY_NAME_GOES_HERE</code> to <code>name</code>, <code>food</code> or
              <code>product</code>. The final code for this would be:</p>
            <pre><code>public class httpResponseClass {

      public class JSONResponse{
      	public Animal animal;
  	}
  	public class Animal{
  		String name, food, product;
  	}

  	public static String methodName() {

          //Make the Request and save it

          String requestURL = 'https://admin2dev.com/rest/response2.json';
          String requestType = 'GET'; //GET POST PATCH PUT DELETE

          Http http = new Http();
          HttpRequest request = new HttpRequest();
          request.setEndpoint(requestURL);
          request.setMethod(requestType);
          HttpResponse response = http.send(request);

          // Deserialize based on result type class
          JSONResponse result = (JSONResponse) JSON.deserialize(response.getBody(), JSONResponse.class);
          return result.animal.name; //Replace JSONObjec with value from JSONResponse and Key_Name with the key you're accessing in the said JSON

     }
  }</code></pre>

            <h1>Résumé</h1>
            <ul>
              <li>Il est important d'avoir des clés JSON nommées exactement dans vairables.</li>
              <li>Il existe plusieurs façons de désérialiser un JSON, mais nous le couvrons ici en crevant des classes parce qu'il nous donne des précisions sur la structure JSON.</li>
            </ul>

            <a href="23.html" class="global-button">Jour 23 : Classe API REST, classe simulée et classe de test</a>
          </div>
        </article>

      </main>
      <footer class="footer-section global-footer">
        <div class="footer-copyright">© <a href="http://harshdeephura.com" target="_blank">Harshdeep Singh Hura</a>.<br>Tous droits réservés.</div>
      </footer>
    </div>
  </div>




  <script src="../assets/js/global.js"></script>




</body></html>
