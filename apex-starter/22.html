<html lang="de-DE"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Apex-Startkurs | Admin2Dev</title>
  <meta name="HandheldFriendly" content="True">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@500&amp;family=Spartan:wght@500;600;700&amp;display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Muli:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="../assets/css/stylesheet.css">

  <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">

  <meta property="og:site_name" content="Admin2Dev">

  <meta property="og:title" content="REST API Class and Making Snippets"> <!-- Content Title-->
  <meta property="og:description" content="Learn the basics of calling a REST API from an Apex Class and how to make code snippets to save time"> <!-- Content Description -->
  <meta property="og:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:url" content="https://admin2dev.com/">


  <meta property="article:author" content="https://twitter.com/kinngh">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="REST API Class and Making Snippets"> <!-- Twitter Title -->
  <meta name="twitter:description" content="Learn the basics of calling a REST API from an Apex Class and how to make code snippets to save time"> <!-- Twitter description -->
  <meta name="twitter:url" content="https://admin2dev.com">
  <meta name="twitter:label1" content="Written by">
  <meta name="twitter:data1" content="Harshdeep Singh Hura">
  <meta name="twitter:label2" content="Filed under">
  <meta name="twitter:data2" content="Apex Tutorials">
  <meta name="twitter:site" content="@kinngh">
  <meta name="twitter:creator" content="@kinngh">
  <meta name="twitter:image" content="https://a2d-cdn.now.sh/web-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-112097931-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
    dataLayer.push(arguments);
  }
  gtag('js', new Date());

  gtag('config', 'UA-112097931-2');
</script><script async src="https://hm-ackee.herokuapp.com/tracker.js" data-ackee-server="https://hm-ackee.herokuapp.com" data-ackee-domain-id="f764576c-4a20-4e1e-af10-84d9528cc19f"></script>

</head>

<body id="myBody" class="global-hash-post-card-amber global-hash-post-card-apricot global-hash-post-card-aqua global-hash-post-card-coral global-hash-post-card-cream global-hash-post-card-green global-hash-post-card-purple global-hash-post-card-raspberry global-hash-post-card-sky is-loaded">
  <div class="global-wrap">
    <div class="global-content">
      <header class="header-section">
        <div class="header-wrap">
          <div class="header-logo">
            <a href="../index.html" class="is-image">
              <img src="../images/logo.png" alt="Admin2Dev">
            </a>
          </div>
          <div class="header-nav">
            <input id="toggle" class="header-checkbox" type="checkbox">
            <label class="header-toggle" for="toggle">
              <span>
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
              </span>
            </label>
            <nav>
              <ul>
                <li><a href="../index.html">Startseite</a></li>
                <li><a href="../learn/index.html">Lernen</a></li>
<li><a href="../tools/index.html">Werkzeuge</a></li>
                 <li><a href="../sponsor/index.html">Sponsor</a></li>
                <li class="header-nav-dropdown">
                  <svg role="img" viewBox="0 0 20 4" xmlns="http://www.w3.org/2000/svg">
                    <path d="M2 4A2 2 0 102.001.001 2 2 0 002 4zm8 0a2 2 0 10.001-3.999A2 2 0 0010 4zm8 0a2 2 0 10.001-3.999A2 2 0 0018 4z"></path></svg>
                  <ul>
                    <li><a href="../about/index.html">Über</a></li><li><a href="../terms.html">Nutzungsbestimmungen</a></li>
                    <li><a href="../privacy.html">Datenschutzerklärung</a></li>
                  </ul>
                </li>
              </ul>
              <ul>
                <li class="signup global-button"><a href="https://discord.gg/5ndr5F8" target="_blank">Treten Sie der Community bei</a></li>
                <li class="signin"><a onclick="darkMode()" id="darkModeText">Dunkler Modus</a></li>
              </ul>
            </nav>
          </div>
        </div>
      </header>
      <main class="global-main">
        <article class="post-section">
          <div class="post-header item is-hero is-page is-first post no-image page">
            <div class="item-container global-color">
              <div class="item-content">
                <h2 class="item-title">REST-API-Klasse und Snippets erstellen</h2>
              </div>
            </div>
          </div>
          <div class="post-content">
            <p>HINWEIS: Dies kann auf den ersten Blick sehr verwirrend sein. Nehmen Sie sich Zeit, um zu verstehen, was passiert.</p>
            <p>Lassen Sie uns dieses Kapitel in zwei Teile aufschlüsseln: Erstens schreiben wir den gesamten Code und rufen eine REST-API auf. Zweitens erstellen wir eine Vorlage, um REST-API-Aufrufe durchzuführen, damit wir den Codeblock immer wieder verwenden können.</p>
            <h1>Teil 1</h1>
            <p>Before we even write the code, we need to <code>whitelist</code> the doman we will be making calls to. In our case, we will be running calls to <code>https://admin2dev.com</code> . Head over to <code>Setup</code> and in Quick Find Box
              search for <code>Remote Site</code> and add new remote site.</p>
            <p>Jetzt, da die Domain auf der Whitelist steht, greifen wir auf unser JSON zu, das unter <a href="https://admin2dev.com/rest/response.json" target="_blank">https://admin2dev.com/rest/response.json </a>verfügbar ist. Während dies ein statischer Link ist, würde eine Antwort genau so funktionieren. Lassen Sie uns zunächst einen GET-Anruf von Postman tätigen und sehen, wie die Antwort lautet:</p>
            <pre><code>{
  	"bird": {
  		"id": 1,
  		"name": "chicken",
  		"food": "wheat",
  		"product": "eggs"
  	}
  }</code></pre>
            <p>Lassen Sie uns diesen JSON aufschlüsseln:</p>
            <ul>
              <li>Wir haben 1 Objekt namens<code>bird</code>
                <ul>
                  <li>It has 4 values. 1 <code>Integer</code> called <strong>id</strong> and 3 <code>String</code> called <strong>name</strong>, <strong>food</strong> and <strong>product</strong></li>
                </ul>
              </li>
            </ul>
            <p>For this, we first write a class named <code>Bird</code> and declare variables named as they are in the JSON with their respective data types.</p>
            <pre><code>public class responseClass{

  	public class Bird {
          public Integer id;
          public String name, food, product;
      }

  }</code></pre>
            <blockquote>
              <p>Der Name der Variablen muss genau mit denen in der JSON-Datei übereinstimmen.</p>
            </blockquote>
            <p>Da sich diese Werte in einem Objekt befinden, müssen wir eine andere Klasse erstellen, die das Objekt als Klasse enthält:</p>
            <pre><code>public class responseClass{


      public class JSONResponse {
          public Bird bird;
      }

      public class Bird {
          public Integer id;
          public String name, food, product;
      }
  }</code></pre>
            <p>What we have done here is recreate the JSON in Apex terms. The <code>public Bird bird</code> defines the variable <code>bird</code> as a <code>Bird</code> class type so now it has access to <code>id</code>, <code>name</code>,
              <code>food</code> and <code>product</code>. This is the most important step of dealing with JSON response, as it should be structured and named exactly as the main JSON file. In the background, what we have done in Apex terms is</p>
            <pre><code>class Bird(){
  	Integer Id;
  	String name, food, product;
  }</code></pre>
            <p>Normalerweise nenne ich die übergeordnete Klasse <code>JSONResponse</code>, da dies die Klasse ist, die wir verwenden werden, um durch unsere JSON-Antwort zu navigieren.</p>
            <p>Jetzt machen wir eine Methode, bei der wir unsere HTTP-Anfrage erstellen und stellen:</p>
            <pre><code>Http http = new Http();
  HttpRequest request = new HttpRequest();

  request.setEndpoint('https://admin2dev.com/rest/response.json');
  request.setMethod('GET');</code></pre>
            <p>Now we need to make the request and store it in a <code>HttpResponse</code> type variable:</p>
            <pre><code>HttpResponse response = http.send(request);</code></pre>
            <p>Jetzt sollte unsere Klasse etwa so aussehen:</p>
            <pre><code>public class responseClass {

      public class JSONResponse {
          public Bird bird;
      }

      public class Bird {
          public Integer id;
          public String name, food, product;
      }

      public static String methodName() {


          Http http = new Http();
          HttpRequest request = new HttpRequest();

          request.setEndpoint('https://admin2dev.com/rest/response.json');
          request.setMethod('GET');

          HttpResponse response = http.send(request);

      }
  }</code></pre>
            <p>Großartig! Nachdem wir den Anruf getätigt und die Antwort gespeichert haben, müssen wir im JSON navigieren. Dieser Prozess wird JSON-Deserialisierung genannt, bei der wir Werte aus dem JSON abrufen und in Variablen speichern.</p>
            <p>Dazu erstellen wir eine neue Variable vom Typ JSONResponse und geben die Antwort auf den JSONResponse-Typ um (wenn Sie es vergessen haben, werfen Sie einen Blick zurück auf Tag 10).</p>
            <pre><code>JSONResponse result = (JSONResponse) JSON.deserialize(response.getBody(), JSONResponse.class);</code></pre>
            <p>Now we get to our value by using <code>result</code> variable that contains our deserialized JSON, followed by the JSONResponse variable <code>bird</code>, followed by the key we are trying to access:</p>
            <pre><code>return result.bird.name;</code></pre>
            <p>Unser Endcode sollte etwa so aussehen:</p>
            <pre><code>public class responseClass {

      public class JSONResponse {
          public Bird bird;
      }

      public class Bird {
          public Integer id;
          public String name, food, product;
      }

      public static String methodName() {


          Http http = new Http();
          HttpRequest request = new HttpRequest();
          request.setEndpoint('https://admin2dev.com/rest/response.json');
          request.setMethod('GET');
          HttpResponse response = http.send(request);

          JSONResponse result = (JSONResponse) JSON.deserialize(response.getBody(), JSONResponse.class);
          return result.bird.name;

      }
  }</code></pre>
            <p>Also haben wir Folgendes getan:</p>
            <ul>
              <li>Erstellte eine <code>JSONResponse</code>-Klasse, die das JSON-Objekt enthält</li>
              <li>Made a class named after the JSON Object (<code>Bird</code>) that holds the values</li>
              <li>Hat eine Methode gemacht, um:<ul>
                  <li>Führen Sie zuerst den HTTP-Aufruf durch</li>
                  <li>Erstellte eine HTTP-Anfrage mit dem<em>, was </em>und <em>wo </em>wir den Aufruf tätigen</li>
                  <li>HTTP-Antwort gespeichert</li>
                  <li>Hat eine Variable erstellt, die die Antwortvariable enthält, wenn sie deserialisiert wird</li>
                  <li>Navigierte durch das Ergebnis und gab es zurück</li>
                </ul>
              </li>
            </ul>
            <p>Während dies viel zu verdauen ist, verwandeln wir es in einen <em>Ausschnitt</em>, eine Art Vorlage, die wie das Ausfüllen der Lücken wiederverwendet werden kann.</p>
            <h1>Teil 2</h1>
            <p>Es ist möglich, so ziemlich zu vermeiden, so viel Code zu schreiben. Aus diesem Grund erstellt jeder effiziente Entwickler seine von ihm verwendeten <em>Snippets</em>. Im Laufe der Jahre habe ich persönlich Snippets für meine iOS / macOS-Apps (Swift), AI (Python) und Apex / Visualforce-Komponenten erstellt. Mal sehen, wie man diesen spezifischen Code in einen Ausschnitt verwandelt:</p>
            <pre><code>public class responseClass {

      public class JSONResponse { //create JSON structure class
      	//Define values as is with data types
      	//Ensure name of the variables matches the JSON keys
      }

  	public static String methodName() {

          //Make the Request and save it

          String requestURL = 'http://url-goes-here.com/';
          String requestType = 'GET'; //GET POST PATCH PUT DELETE

          Http http = new Http();
          HttpRequest request = new HttpRequest();
          request.setEndpoint(requestURL);
          request.setMethod(requestType);
          HttpResponse response = http.send(request);

          // Deserialize based on result type class
          JSONResponse result = (JSONResponse) JSON.deserialize(response.getBody(), JSONResponse.class);
          return result.JSONObject.Key_Name //Replace JSONObject with value from JSONResponse and Key_Name with the key you're accessing in the said JSON

     }
  }</code></pre>
            <p>Now this snippet is a simple copy paste away to making a call to simple JSON File. You'll notice how a lot of the code that we wrote was bunch of code that was <em>as is</em>, meaning we don't really need to remember what we're doing
              here, and can be turned into a <em>template</em> or a <em>snippet</em> to get things done. In this particular example, we only need to update the <code>JSONResponse</code>, <code>requestURL</code>, <code>requestType</code> and the
              <code>return</code> value at the end, which is much simpler than remembering to define HTTP variables and calling and saving responses over and over again.</p>
            <p>Snippets zu erstellen ist wirklich wichtig, da es Ihre Arbeitsbelastung um einen Abschnitt reduziert, so dass Sie Ihren Code über mehrere Organisationen wiederverwenden können, ohne viel ändern zu müssen. Es ist jedoch immer noch wichtig zu wissen, was jede Codezeile bewirkt, und Ihren Code richtig zu kommentieren. Wenn es zu einem späteren Zeitpunkt Änderungen an der Funktionsweise von Apex gibt, ist es einfach, Ihre Snippet-Bibliothek zu aktualisieren.</p>
            <p>I have my snippet library stored and organized in my private repo that I usually refer to, which now is open sourced and available with documentation at <a href="https://github.com/Admin2Dev/apex-snippets" target="_blank">https://github.com/Admin2Dev/apex-snippets</a> that covers commonly used classes along with tests! Feel free to <code>fork</code> the code which allows you to copy the code in your
              github repo and make changes to it!</p>
            <p>Versuchen wir es mit einer neuen JSON-Antwort! Hier ist die URL: <a href="https://admin2dev.com/rest/response2.json" target="_blank">https://admin2dev.com/rest/response2.json</a>. Verwenden Sie den obigen Ausschnitt, um einen beliebigen Wert aus der Antwort zurückzugeben. Falls Sie nicht weiterkommen, hier ist der JSON und der Code:</p>
            <p>Zuerst verwenden wir Postman, um den JSON zu erhalten:</p>
            <pre><code>{
  	"animal": {
  		"name": "cow",
  		"food": "grass",
  		"product": "milk"
  	}
  }</code></pre>
            <p>Jetzt kopieren wir das <em>Snippet </em>und ändern den Klassennamen:</p>
            <pre><code>public class httpResponseClass {

      public class JSONResponse { //create JSON structure class
      	//Define values as is with data types
      	//Ensure name of the variables matches the JSON keys
      }

  	public static String methodName() {

          //Make the Request and save it

          String requestURL = 'http://url-goes-here.com/';
          String requestType = 'GET'; //GET POST PATCH PUT DELETE

          Http http = new Http();
          HttpRequest request = new HttpRequest();
          request.setEndpoint(requestURL);
          request.setMethod(requestType);
          HttpResponse response = http.send(request);

          // Deserialize based on result type class
          JSONResponse result = (JSONResponse) JSON.deserialize(response.getBody(), JSONResponse.class);
          return result.JSONObject.Key_Name //Replace JSONObject with value from JSONResponse and Key_Name with the key you're accessing in the said JSON

     }
  }</code></pre>
            <p>Jetzt bauen wir unsere JSON-Struktur auf und speichern sie</p>
            <pre><code>public class JSONResponse{
  	public Animal animal;
  }
  public class Animal{
  	String name, food, product;
  }</code></pre>
            <p>Now we update the <code>requestURL</code> to <code>https://admin2dev.com/rest/response2.json</code>, <code>JSONObject</code> to <code>animal</code> and <code>KEY_NAME_GOES_HERE</code> to <code>name</code>, <code>food</code> or
              <code>product</code>. The final code for this would be:</p>
            <pre><code>public class httpResponseClass {

      public class JSONResponse{
      	public Animal animal;
  	}
  	public class Animal{
  		String name, food, product;
  	}

  	public static String methodName() {

          //Make the Request and save it

          String requestURL = 'https://admin2dev.com/rest/response2.json';
          String requestType = 'GET'; //GET POST PATCH PUT DELETE

          Http http = new Http();
          HttpRequest request = new HttpRequest();
          request.setEndpoint(requestURL);
          request.setMethod(requestType);
          HttpResponse response = http.send(request);

          // Deserialize based on result type class
          JSONResponse result = (JSONResponse) JSON.deserialize(response.getBody(), JSONResponse.class);
          return result.animal.name; //Replace JSONObjec with value from JSONResponse and Key_Name with the key you're accessing in the said JSON

     }
  }</code></pre>

            <h1>Zusammenfassung</h1>
            <ul>
              <li>Es ist wichtig, dass JSON-Schlüssel genau in Vairables benannt werden.</li>
              <li>Es gibt mehrere Möglichkeiten, einen JSON zu deserialisieren, aber wir decken ihn hier ab, indem wir Klassen erstellen, weil er uns Klarheit über die JSON-Struktur gibt.</li>
            </ul>

            <a href="23.html" class="global-button">Tag 23: REST-API-Klasse, Scheinklasse und Testklasse</a>
          </div>
        </article>

      </main>
      <footer class="footer-section global-footer">
        <div class="footer-copyright">© <a href="http://harshdeephura.com" target="_blank">Harshdeep Singh Hura</a>.<br>Alle Rechte vorbehalten.</div>
      </footer>
    </div>
  </div>




  <script src="../assets/js/global.js"></script>




</body></html>
